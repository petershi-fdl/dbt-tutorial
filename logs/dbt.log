2021-06-23 04:51:04.635335 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 04:51:04.947845 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 04:51:04.956787 (MainThread): Tracking: tracking
2021-06-23 04:51:04.965413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B2DE7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3A16340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3A16C40>]}
2021-06-23 04:51:04.980402 (MainThread): Partial parsing not enabled
2021-06-23 04:51:05.181923 (MainThread): Parsing macros\adapters.sql
2021-06-23 04:51:05.197880 (MainThread): Parsing macros\catalog.sql
2021-06-23 04:51:05.202867 (MainThread): Parsing macros\etc.sql
2021-06-23 04:51:05.204861 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 04:51:05.207853 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 04:51:05.218858 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 04:51:05.220853 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 04:51:05.222848 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 04:51:05.231789 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 04:51:05.233784 (MainThread): Parsing macros\core.sql
2021-06-23 04:51:05.236776 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 04:51:05.277666 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 04:51:05.285645 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 04:51:05.286643 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 04:51:05.287640 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 04:51:05.288637 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 04:51:05.290632 (MainThread): Parsing macros\etc\query.sql
2021-06-23 04:51:05.290632 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 04:51:05.300607 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 04:51:05.305593 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 04:51:05.318592 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 04:51:05.320586 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 04:51:05.329529 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 04:51:05.347481 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 04:51:05.374442 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 04:51:05.376437 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 04:51:05.391365 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 04:51:05.398380 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 04:51:05.402368 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 04:51:05.408352 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 04:51:05.409350 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 04:51:05.410347 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 04:51:05.412309 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 04:51:05.569921 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 04:51:05.577900 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 04:51:05.601834 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 04:51:05.603828 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 04:51:05.605826 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 04:51:05.606820 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 04:51:05.630916 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c1d11db-f6c1-4a4f-87ce-cc24f0bc475e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3B580D0>]}
2021-06-23 04:51:05.636899 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c1d11db-f6c1-4a4f-87ce-cc24f0bc475e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3A05490>]}
2021-06-23 04:51:05.636899 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 04:51:05.638894 (MainThread): 
2021-06-23 04:51:05.638894 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 04:51:05.639891 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 04:51:05.640897 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 04:51:06.557800 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_silent-caster-317703_dbt_petershi".
2021-06-23 04:51:06.557800 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_silent-caster-317703_dbt_petershi".
2021-06-23 04:51:06.557800 (ThreadPoolExecutor-0_0): Creating schema "silent-caster-317703.dbt_petershi".
2021-06-23 04:51:06.557800 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-23 04:51:06.561787 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 04:51:07.678312 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 04:51:07.678312 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 04:51:07.682303 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 04:51:08.589952 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi_dbt_test__audit".
2021-06-23 04:51:08.589952 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-23 04:51:08.592943 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 04:51:09.644581 (MainThread): 16:51:09 | Concurrency: 1 threads (target='dev')
2021-06-23 04:51:09.644581 (MainThread): 16:51:09 | 
2021-06-23 04:51:09.662167 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-06-23 04:51:09.662167 (Thread-1): 16:51:09 | 1 of 2 START table model dbt_petershi.my_first_dbt_model............. [RUN]
2021-06-23 04:51:09.663297 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 04:51:09.663297 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-06-23 04:51:09.665294 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 04:51:09.667289 (Thread-1): finished collecting timing info
2021-06-23 04:51:09.699204 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 04:51:09.700201 (Thread-1): Opening a new connection, currently in state init
2021-06-23 04:51:09.704189 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-06-23 04:51:13.870838 (Thread-1): finished collecting timing info
2021-06-23 04:51:13.870838 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1d11db-f6c1-4a4f-87ce-cc24f0bc475e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3BCC3A0>]}
2021-06-23 04:51:13.870838 (Thread-1): 16:51:13 | 1 of 2 OK created table model dbt_petershi.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 4.21s]
2021-06-23 04:51:13.872568 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-06-23 04:51:13.872800 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-06-23 04:51:13.872800 (Thread-1): 16:51:13 | 2 of 2 START view model dbt_petershi.my_second_dbt_model............. [RUN]
2021-06-23 04:51:13.873466 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 04:51:13.873466 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-06-23 04:51:13.874353 (Thread-1): unclosed <ssl.SSLSocket fd=328, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57921), raddr=('142.250.67.10', 443)>
2021-06-23 04:51:13.874353 (Thread-1): unclosed <ssl.SSLSocket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57922), raddr=('142.250.66.202', 443)>
2021-06-23 04:51:13.875353 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 04:51:13.876350 (Thread-1): finished collecting timing info
2021-06-23 04:51:13.892307 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 04:51:13.893304 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 04:51:13.897293 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
where id = 1;


2021-06-23 04:51:16.219492 (Thread-1): finished collecting timing info
2021-06-23 04:51:16.219492 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c1d11db-f6c1-4a4f-87ce-cc24f0bc475e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3AFC370>]}
2021-06-23 04:51:16.219492 (Thread-1): 16:51:16 | 2 of 2 OK created view model dbt_petershi.my_second_dbt_model........ [OK in 2.35s]
2021-06-23 04:51:16.221151 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-06-23 04:51:16.221987 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 04:51:16.221987 (MainThread): 16:51:16 | 
2021-06-23 04:51:16.222548 (MainThread): 16:51:16 | Finished running 1 table model, 1 view model in 10.58s.
2021-06-23 04:51:16.222548 (MainThread): Connection 'master' was properly closed.
2021-06-23 04:51:16.222548 (MainThread): Connection 'create_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 04:51:16.222548 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi_dbt_test__audit' was properly closed.
2021-06-23 04:51:16.222548 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-06-23 04:51:16.227538 (MainThread): 
2021-06-23 04:51:16.227538 (MainThread): Completed successfully
2021-06-23 04:51:16.228536 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-23 04:51:16.228536 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B3A05FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B280AF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252B2DE7760>]}
2021-06-23 04:51:16.228536 (MainThread): Flushing usage events
2021-06-23 05:02:19.455232 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:02:19.758952 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:02:19.758952 (MainThread): Tracking: tracking
2021-06-23 05:02:19.774573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B4317910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B4F47340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B4F47C40>]}
2021-06-23 05:02:19.774573 (MainThread): Partial parsing not enabled
2021-06-23 05:02:19.790195 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:02:19.821438 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:02:19.827943 (MainThread): Parsing macros\etc.sql
2021-06-23 05:02:19.827943 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:02:19.827943 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:02:19.847237 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:02:19.849349 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:02:19.850353 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:02:19.850353 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:02:19.850353 (MainThread): Parsing macros\core.sql
2021-06-23 05:02:19.850353 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:02:19.897220 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:02:19.897220 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:02:19.897220 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:02:19.912842 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:02:19.912842 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:02:19.912842 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:02:19.912842 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:02:19.912842 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:02:19.927848 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:02:19.927848 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:02:19.943504 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:02:19.943504 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:02:19.959126 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:02:19.990371 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:02:19.990371 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:02:20.011946 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:02:20.017933 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:02:20.021921 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:02:20.028089 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:02:20.030203 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:02:20.030203 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:02:20.030203 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:02:20.190962 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:02:20.193077 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 05:02:20.201161 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 05:02:20.223660 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:02:20.223660 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:02:20.223660 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:02:20.223660 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:02:20.231702 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2bf855e-9382-4415-94a2-e12671dc05e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B508E0D0>]}
2021-06-23 05:02:20.243861 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2bf855e-9382-4415-94a2-e12671dc05e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B5043070>]}
2021-06-23 05:02:20.243861 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:02:20.243861 (MainThread): 
2021-06-23 05:02:20.243861 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:02:20.243861 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:02:20.243861 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:02:21.273470 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:02:21.273470 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:02:21.273470 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:02:22.236365 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi_dbt_test__audit".
2021-06-23 05:02:22.236365 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-23 05:02:22.236365 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:02:22.236365 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=888, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57863), raddr=('142.250.71.74', 443)>
2021-06-23 05:02:22.236365 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=912, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57864), raddr=('142.250.66.202', 443)>
2021-06-23 05:02:23.323397 (MainThread): 17:02:23 | Concurrency: 1 threads (target='dev')
2021-06-23 05:02:23.323397 (MainThread): 17:02:23 | 
2021-06-23 05:02:23.338627 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-06-23 05:02:23.338627 (Thread-1): 17:02:23 | 1 of 3 START table model dbt_petershi.my_first_dbt_model............. [RUN]
2021-06-23 05:02:23.338627 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 05:02:23.338627 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-06-23 05:02:23.338627 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 05:02:23.338627 (Thread-1): finished collecting timing info
2021-06-23 05:02:23.360779 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:02:23.360779 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:02:24.262326 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 05:02:24.262326 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-06-23 05:02:28.132106 (Thread-1): finished collecting timing info
2021-06-23 05:02:28.132106 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2bf855e-9382-4415-94a2-e12671dc05e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B50205B0>]}
2021-06-23 05:02:28.133104 (Thread-1): 17:02:28 | 1 of 3 OK created table model dbt_petershi.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 4.79s]
2021-06-23 05:02:28.134102 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-06-23 05:02:28.134102 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:02:28.135098 (Thread-1): 17:02:28 | 2 of 3 START view model dbt_petershi.customers....................... [RUN]
2021-06-23 05:02:28.135098 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:02:28.135098 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:02:28.137093 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:02:28.137093 (Thread-1): finished collecting timing info
2021-06-23 05:02:28.152052 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:02:28.153050 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:02:28.154137 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-06-23 05:02:30.465489 (Thread-1): finished collecting timing info
2021-06-23 05:02:30.465489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2bf855e-9382-4415-94a2-e12671dc05e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B4F86A00>]}
2021-06-23 05:02:30.465489 (Thread-1): 17:02:30 | 2 of 3 OK created view model dbt_petershi.customers.................. [OK in 2.33s]
2021-06-23 05:02:30.465489 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:02:30.465489 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-06-23 05:02:30.465489 (Thread-1): 17:02:30 | 3 of 3 START view model dbt_petershi.my_second_dbt_model............. [RUN]
2021-06-23 05:02:30.465489 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 05:02:30.465489 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-06-23 05:02:30.465489 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 05:02:30.465489 (Thread-1): finished collecting timing info
2021-06-23 05:02:30.465489 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 05:02:30.465489 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:02:30.483225 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
where id = 1;


2021-06-23 05:02:30.646234 (Thread-1): unclosed <ssl.SSLSocket fd=1044, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 60402), raddr=('142.250.66.202', 443)>
2021-06-23 05:02:30.646234 (Thread-1): unclosed <ssl.SSLSocket fd=1032, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57867), raddr=('142.250.71.74', 443)>
2021-06-23 05:02:30.646234 (Thread-1): unclosed <ssl.SSLSocket fd=1124, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 60403), raddr=('142.250.71.74', 443)>
2021-06-23 05:02:30.646234 (Thread-1): unclosed <ssl.SSLSocket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 60404), raddr=('142.250.66.202', 443)>
2021-06-23 05:02:32.595774 (Thread-1): finished collecting timing info
2021-06-23 05:02:32.595774 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2bf855e-9382-4415-94a2-e12671dc05e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B4FD21C0>]}
2021-06-23 05:02:32.595774 (Thread-1): 17:02:32 | 3 of 3 OK created view model dbt_petershi.my_second_dbt_model........ [OK in 2.13s]
2021-06-23 05:02:32.609982 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-06-23 05:02:32.610989 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:02:32.610989 (MainThread): 17:02:32 | 
2021-06-23 05:02:32.610989 (MainThread): 17:02:32 | Finished running 1 table model, 2 view models in 12.37s.
2021-06-23 05:02:32.624839 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:02:32.624839 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:02:32.624839 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi_dbt_test__audit' was properly closed.
2021-06-23 05:02:32.624839 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-06-23 05:02:32.654870 (MainThread): 
2021-06-23 05:02:32.654870 (MainThread): Completed successfully
2021-06-23 05:02:32.655878 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-23 05:02:32.655878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B3DE14C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B509FF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179B50CE070>]}
2021-06-23 05:02:32.655878 (MainThread): Flushing usage events
2021-06-23 05:21:57.750809 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:21:58.055800 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:21:58.055800 (MainThread): Tracking: tracking
2021-06-23 05:21:58.063106 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204213A7C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424BC28E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424BC2EE0>]}
2021-06-23 05:21:58.071086 (MainThread): Partial parsing not enabled
2021-06-23 05:21:58.087067 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:21:58.104022 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:21:58.109018 (MainThread): Parsing macros\etc.sql
2021-06-23 05:21:58.110022 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:21:58.114004 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:21:58.123976 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:21:58.125971 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:21:58.127989 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:21:58.135951 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:21:58.137939 (MainThread): Parsing macros\core.sql
2021-06-23 05:21:58.140931 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:21:58.180563 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:21:58.188543 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:21:58.188543 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:21:58.190539 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:21:58.191534 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:21:58.192531 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:21:58.193530 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:21:58.202507 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:21:58.207492 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:21:58.219460 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:21:58.221455 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:21:58.229434 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:21:58.246388 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:21:58.272321 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:21:58.273320 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:21:58.288279 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:21:58.294262 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:21:58.298250 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:21:58.304236 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:21:58.306229 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:21:58.307226 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:21:58.308223 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:21:58.462714 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:21:58.469728 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 05:21:58.472720 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 05:21:58.495626 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:21:58.497653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:21:58.498651 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:21:58.500650 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:21:58.511581 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '586a8f54-eb43-41af-b89b-502b53e81abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424D320D0>]}
2021-06-23 05:21:58.516576 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '586a8f54-eb43-41af-b89b-502b53e81abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424D182E0>]}
2021-06-23 05:21:58.516576 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:21:58.517567 (MainThread): 
2021-06-23 05:21:58.518565 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:21:58.519563 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:21:58.519563 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:21:59.714878 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:21:59.714878 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:21:59.718871 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:22:00.593181 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi_dbt_test__audit".
2021-06-23 05:22:00.593181 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-23 05:22:00.597146 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:22:00.597146 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=748, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 53663), raddr=('142.250.204.10', 443)>
2021-06-23 05:22:00.598130 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=768, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 53664), raddr=('142.250.66.202', 443)>
2021-06-23 05:22:01.678204 (MainThread): 17:22:01 | Concurrency: 1 threads (target='dev')
2021-06-23 05:22:01.678204 (MainThread): 17:22:01 | 
2021-06-23 05:22:01.687508 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-06-23 05:22:01.688505 (Thread-1): 17:22:01 | 1 of 3 START table model dbt_petershi.my_first_dbt_model............. [RUN]
2021-06-23 05:22:01.688505 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 05:22:01.688505 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-06-23 05:22:01.690536 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 05:22:01.691532 (Thread-1): finished collecting timing info
2021-06-23 05:22:01.706493 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:22:01.710480 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:22:02.584221 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 05:22:02.584221 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-06-23 05:22:06.740836 (Thread-1): finished collecting timing info
2021-06-23 05:22:06.740836 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586a8f54-eb43-41af-b89b-502b53e81abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424CA9BE0>]}
2021-06-23 05:22:06.741837 (Thread-1): 17:22:06 | 1 of 3 OK created table model dbt_petershi.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 5.05s]
2021-06-23 05:22:06.742942 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-06-23 05:22:06.742942 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:22:06.742942 (Thread-1): 17:22:06 | 2 of 3 START table model dbt_petershi.customers...................... [RUN]
2021-06-23 05:22:06.742942 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:22:06.743958 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:22:06.744970 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:22:06.744970 (Thread-1): finished collecting timing info
2021-06-23 05:22:06.745966 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:22:06.749945 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:22:07.740049 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:22:08.312269 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:22:08.312269 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-23 05:22:12.871852 (Thread-1): finished collecting timing info
2021-06-23 05:22:12.871852 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586a8f54-eb43-41af-b89b-502b53e81abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424CA98B0>]}
2021-06-23 05:22:12.871852 (Thread-1): 17:22:12 | 2 of 3 OK created table model dbt_petershi.customers................. [CREATE TABLE (100.0 rows, 4.3 KB processed) in 6.13s]
2021-06-23 05:22:12.873743 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:22:12.873743 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-06-23 05:22:12.873743 (Thread-1): 17:22:12 | 3 of 3 START view model dbt_petershi.my_second_dbt_model............. [RUN]
2021-06-23 05:22:12.873743 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 05:22:12.873743 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-06-23 05:22:12.874776 (Thread-1): unclosed <ssl.SSLSocket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 53669), raddr=('142.250.204.10', 443)>
2021-06-23 05:22:12.874776 (Thread-1): unclosed <ssl.SSLSocket fd=1120, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 53670), raddr=('142.250.66.202', 443)>
2021-06-23 05:22:12.876738 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 05:22:12.876738 (Thread-1): finished collecting timing info
2021-06-23 05:22:12.891731 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 05:22:12.892694 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:22:12.896717 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
where id = 1;


2021-06-23 05:22:12.897717 (Thread-1): unclosed <ssl.SSLSocket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 53668), raddr=('142.250.66.202', 443)>
2021-06-23 05:22:12.897717 (Thread-1): unclosed <ssl.SSLSocket fd=1032, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 53667), raddr=('142.250.204.10', 443)>
2021-06-23 05:22:15.030324 (Thread-1): finished collecting timing info
2021-06-23 05:22:15.030324 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586a8f54-eb43-41af-b89b-502b53e81abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424BA9310>]}
2021-06-23 05:22:15.030324 (Thread-1): 17:22:15 | 3 of 3 OK created view model dbt_petershi.my_second_dbt_model........ [OK in 2.16s]
2021-06-23 05:22:15.031832 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-06-23 05:22:15.031832 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:22:15.032861 (MainThread): 17:22:15 | 
2021-06-23 05:22:15.032861 (MainThread): 17:22:15 | Finished running 2 table models, 1 view model in 16.51s.
2021-06-23 05:22:15.032861 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:22:15.032861 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:22:15.032861 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi_dbt_test__audit' was properly closed.
2021-06-23 05:22:15.032861 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-06-23 05:22:15.038843 (MainThread): 
2021-06-23 05:22:15.038843 (MainThread): Completed successfully
2021-06-23 05:22:15.039828 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-23 05:22:15.039828 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424CCCDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424BADB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020424BA5970>]}
2021-06-23 05:22:15.039828 (MainThread): Flushing usage events
2021-06-23 05:24:19.364465 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:24:19.694872 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=True, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:24:19.695870 (MainThread): Tracking: tracking
2021-06-23 05:24:19.703246 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0BC98640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C8A3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C8A3430>]}
2021-06-23 05:24:19.712221 (MainThread): Partial parsing not enabled
2021-06-23 05:24:19.728178 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:24:19.744136 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:24:19.749122 (MainThread): Parsing macros\etc.sql
2021-06-23 05:24:19.750120 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:24:19.754109 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:24:19.765080 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:24:19.767074 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:24:19.768072 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:24:19.778045 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:24:19.780040 (MainThread): Parsing macros\core.sql
2021-06-23 05:24:19.783032 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:24:19.823926 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:24:19.831903 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:24:19.831903 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:24:19.833897 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:24:19.834895 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:24:19.835892 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:24:19.837887 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:24:19.845898 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:24:19.851882 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:24:19.863850 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:24:19.864848 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:24:19.873827 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:24:19.891777 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:24:19.921694 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:24:19.922687 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:24:19.937659 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:24:19.943637 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:24:19.947626 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:24:19.954604 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:24:19.956603 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:24:19.957600 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:24:19.958597 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:24:20.117175 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:24:20.127148 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 05:24:20.130139 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 05:24:20.154042 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:24:20.156070 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:24:20.158066 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:24:20.159063 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:24:20.174986 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebe5c8f3-4f02-4120-a8b7-bac1c36b1a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C9D10D0>]}
2021-06-23 05:24:20.179973 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebe5c8f3-4f02-4120-a8b7-bac1c36b1a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C9F0C10>]}
2021-06-23 05:24:20.179973 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:24:20.180969 (MainThread): 
2021-06-23 05:24:20.180969 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:24:20.181967 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:24:20.182994 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:24:21.117917 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi_dbt_test__audit".
2021-06-23 05:24:21.117917 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:24:21.121977 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:24:22.194836 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:24:22.194836 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-23 05:24:22.198829 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:24:22.199827 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=900, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57740), raddr=('142.250.66.234', 443)>
2021-06-23 05:24:22.199827 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=692, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57741), raddr=('142.250.66.202', 443)>
2021-06-23 05:24:23.086652 (MainThread): 17:24:23 | Concurrency: 1 threads (target='dev')
2021-06-23 05:24:23.087394 (MainThread): 17:24:23 | 
2021-06-23 05:24:23.090596 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-06-23 05:24:23.090596 (Thread-1): 17:24:23 | 1 of 3 START table model dbt_petershi.my_first_dbt_model............. [RUN]
2021-06-23 05:24:23.090596 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-23 05:24:23.090596 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-06-23 05:24:23.090596 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 05:24:23.090596 (Thread-1): finished collecting timing info
2021-06-23 05:24:23.115359 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:24:23.119349 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:24:24.047334 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-23 05:24:24.048331 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-06-23 05:24:27.755851 (Thread-1): finished collecting timing info
2021-06-23 05:24:27.755851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe5c8f3-4f02-4120-a8b7-bac1c36b1a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C908F10>]}
2021-06-23 05:24:27.755851 (Thread-1): 17:24:27 | 1 of 3 OK created table model dbt_petershi.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 4.67s]
2021-06-23 05:24:27.757831 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-06-23 05:24:27.757831 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:24:27.757831 (Thread-1): 17:24:27 | 2 of 3 START view model dbt_petershi.customers....................... [RUN]
2021-06-23 05:24:27.757831 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:24:27.757831 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:24:27.759862 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:24:27.760860 (Thread-1): finished collecting timing info
2021-06-23 05:24:27.765011 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:24:27.779199 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:24:28.729596 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:24:28.729596 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-06-23 05:24:30.674192 (Thread-1): finished collecting timing info
2021-06-23 05:24:30.674192 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe5c8f3-4f02-4120-a8b7-bac1c36b1a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C9CADC0>]}
2021-06-23 05:24:30.674192 (Thread-1): 17:24:30 | 2 of 3 OK created view model dbt_petershi.customers.................. [OK in 2.92s]
2021-06-23 05:24:30.675866 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:24:30.675866 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-06-23 05:24:30.675866 (Thread-1): 17:24:30 | 3 of 3 START view model dbt_petershi.my_second_dbt_model............. [RUN]
2021-06-23 05:24:30.675866 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-23 05:24:30.675866 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-06-23 05:24:30.677897 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 05:24:30.678896 (Thread-1): finished collecting timing info
2021-06-23 05:24:30.681853 (Thread-1): unclosed <ssl.SSLSocket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57745), raddr=('142.250.66.202', 443)>
2021-06-23 05:24:30.681853 (Thread-1): unclosed <ssl.SSLSocket fd=1032, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57744), raddr=('142.250.66.234', 443)>
2021-06-23 05:24:30.681853 (Thread-1): unclosed <ssl.SSLSocket fd=1136, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57746), raddr=('142.250.66.234', 443)>
2021-06-23 05:24:30.681853 (Thread-1): unclosed <ssl.SSLSocket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57747), raddr=('142.250.66.202', 443)>
2021-06-23 05:24:30.682851 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-23 05:24:30.682851 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:24:30.686872 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
where id = 1;


2021-06-23 05:24:32.665033 (Thread-1): finished collecting timing info
2021-06-23 05:24:32.666025 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebe5c8f3-4f02-4120-a8b7-bac1c36b1a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C88ACA0>]}
2021-06-23 05:24:32.666025 (Thread-1): 17:24:32 | 3 of 3 OK created view model dbt_petershi.my_second_dbt_model........ [OK in 1.99s]
2021-06-23 05:24:32.667089 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-06-23 05:24:32.667089 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:24:32.667089 (MainThread): 17:24:32 | 
2021-06-23 05:24:32.667089 (MainThread): 17:24:32 | Finished running 1 table model, 2 view models in 12.49s.
2021-06-23 05:24:32.667089 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:24:32.667089 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:24:32.667089 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 05:24:32.667089 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2021-06-23 05:24:32.667089 (MainThread): unclosed <ssl.SSLSocket fd=672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57749), raddr=('142.250.66.234', 443)>
2021-06-23 05:24:32.667089 (MainThread): unclosed <ssl.SSLSocket fd=616, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 57750), raddr=('142.250.66.202', 443)>
2021-06-23 05:24:32.667089 (MainThread): 
2021-06-23 05:24:32.676605 (MainThread): Completed successfully
2021-06-23 05:24:32.676605 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-23 05:24:32.676605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C9F0AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C978F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0C9787F0>]}
2021-06-23 05:24:32.676605 (MainThread): Flushing usage events
2021-06-23 05:35:07.101160 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:35:07.420044 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:35:07.420044 (MainThread): Tracking: tracking
2021-06-23 05:35:07.420044 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319EA08490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F636670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F636F70>]}
2021-06-23 05:35:07.436462 (MainThread): Partial parsing not enabled
2021-06-23 05:35:07.450459 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:35:07.466416 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:35:07.472400 (MainThread): Parsing macros\etc.sql
2021-06-23 05:35:07.473645 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:35:07.473645 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:35:07.473645 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:35:07.489300 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:35:07.489300 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:35:07.489300 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:35:07.489300 (MainThread): Parsing macros\core.sql
2021-06-23 05:35:07.489300 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:35:07.539673 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:35:07.539673 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:35:07.539673 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:35:07.539673 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:35:07.555299 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:35:07.555299 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:35:07.555299 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:35:07.555299 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:35:07.570920 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:35:07.570920 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:35:07.570920 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:35:07.586541 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:35:07.602194 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:35:07.633437 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:35:07.633437 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:35:07.639974 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:35:07.655631 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:35:07.655631 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:35:07.655631 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:35:07.655631 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:35:07.655631 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:35:07.671254 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:35:07.824356 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:35:07.824356 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:35:07.824356 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:35:07.840536 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdc064d8-c977-46d0-b861-81a78d78cc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F6F70D0>]}
2021-06-23 05:35:07.856185 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdc064d8-c977-46d0-b861-81a78d78cc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F6F7BB0>]}
2021-06-23 05:35:07.856185 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:35:07.856185 (MainThread): 
2021-06-23 05:35:07.856185 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:35:07.856185 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:35:07.856185 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:35:08.870709 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:35:08.870709 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:35:08.870709 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:35:09.737511 (MainThread): 17:35:09 | Concurrency: 1 threads (target='dev')
2021-06-23 05:35:09.737511 (MainThread): 17:35:09 | 
2021-06-23 05:35:09.771946 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-23 05:35:09.771946 (Thread-1): 17:35:09 | 1 of 3 START view model dbt_petershi.stg_customers................... [RUN]
2021-06-23 05:35:09.771946 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:35:09.771946 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-23 05:35:09.771946 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 05:35:09.771946 (Thread-1): finished collecting timing info
2021-06-23 05:35:09.818864 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 05:35:09.818864 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:35:09.818864 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-06-23 05:35:12.240593 (Thread-1): finished collecting timing info
2021-06-23 05:35:12.240593 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc064d8-c977-46d0-b861-81a78d78cc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F668DF0>]}
2021-06-23 05:35:12.240593 (Thread-1): 17:35:12 | 1 of 3 OK created view model dbt_petershi.stg_customers.............. [OK in 2.47s]
2021-06-23 05:35:12.240593 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-23 05:35:12.240593 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-23 05:35:12.240593 (Thread-1): 17:35:12 | 2 of 3 START view model dbt_petershi.stg_orders...................... [RUN]
2021-06-23 05:35:12.240593 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:35:12.240593 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-23 05:35:12.240593 (Thread-1): unclosed <ssl.SSLSocket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49273), raddr=('172.217.167.74', 443)>
2021-06-23 05:35:12.240593 (Thread-1): unclosed <ssl.SSLSocket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49274), raddr=('142.250.66.202', 443)>
2021-06-23 05:35:12.240593 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 05:35:12.258337 (Thread-1): finished collecting timing info
2021-06-23 05:35:12.258337 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 05:35:12.258337 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:35:12.258337 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2021-06-23 05:35:14.419183 (Thread-1): finished collecting timing info
2021-06-23 05:35:14.419183 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc064d8-c977-46d0-b861-81a78d78cc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F5B8250>]}
2021-06-23 05:35:14.419183 (Thread-1): 17:35:14 | 2 of 3 OK created view model dbt_petershi.stg_orders................. [OK in 2.18s]
2021-06-23 05:35:14.419183 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-23 05:35:14.419183 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:35:14.419183 (Thread-1): 17:35:14 | 3 of 3 START view model dbt_petershi.customers....................... [RUN]
2021-06-23 05:35:14.434462 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:35:14.434462 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:35:14.435363 (Thread-1): unclosed <ssl.SSLSocket fd=916, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49275), raddr=('172.217.167.74', 443)>
2021-06-23 05:35:14.435363 (Thread-1): unclosed <ssl.SSLSocket fd=1128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49276), raddr=('142.250.66.202', 443)>
2021-06-23 05:35:14.437376 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:35:14.438373 (Thread-1): finished collecting timing info
2021-06-23 05:35:14.441331 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:35:14.441331 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:35:14.445321 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
  OPTIONS()
  as 

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-06-23 05:35:16.511054 (Thread-1): finished collecting timing info
2021-06-23 05:35:16.511054 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdc064d8-c977-46d0-b861-81a78d78cc90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F5E68E0>]}
2021-06-23 05:35:16.511054 (Thread-1): 17:35:16 | 3 of 3 OK created view model dbt_petershi.customers.................. [OK in 2.08s]
2021-06-23 05:35:16.511054 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:35:16.511054 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:35:16.511054 (MainThread): 17:35:16 | 
2021-06-23 05:35:16.511054 (MainThread): 17:35:16 | Finished running 3 view models in 8.65s.
2021-06-23 05:35:16.511054 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:35:16.511054 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:35:16.511054 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 05:35:16.511054 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-23 05:35:16.526310 (MainThread): unclosed <ssl.SSLSocket fd=1032, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49277), raddr=('172.217.167.74', 443)>
2021-06-23 05:35:16.526310 (MainThread): unclosed <ssl.SSLSocket fd=928, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49278), raddr=('142.250.66.202', 443)>
2021-06-23 05:35:16.526310 (MainThread): 
2021-06-23 05:35:16.526310 (MainThread): Completed successfully
2021-06-23 05:35:16.526310 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-23 05:35:16.526310 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F75BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F668DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319F6CE640>]}
2021-06-23 05:35:16.526310 (MainThread): Flushing usage events
2021-06-23 05:35:53.807883 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:35:54.116650 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['customers'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:35:54.117647 (MainThread): Tracking: tracking
2021-06-23 05:35:54.125600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC078D76A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC08516670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC08516F70>]}
2021-06-23 05:35:54.133579 (MainThread): Partial parsing not enabled
2021-06-23 05:35:54.148565 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:35:54.166492 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:35:54.171504 (MainThread): Parsing macros\etc.sql
2021-06-23 05:35:54.174470 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:35:54.178064 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:35:54.188609 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:35:54.190604 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:35:54.191602 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:35:54.200544 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:35:54.202565 (MainThread): Parsing macros\core.sql
2021-06-23 05:35:54.205564 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:35:54.246423 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:35:54.254402 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:35:54.254402 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:35:54.256397 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:35:54.257394 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:35:54.258391 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:35:54.259388 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:35:54.268397 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:35:54.274384 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:35:54.286319 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:35:54.287340 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:35:54.295334 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:35:54.313278 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:35:54.340207 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:35:54.341205 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:35:54.357161 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:35:54.363146 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:35:54.368100 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:35:54.374119 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:35:54.375115 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:35:54.376111 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:35:54.378109 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:35:54.535655 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:35:54.544664 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:35:54.545664 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:35:54.564604 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bde423a-b59a-4eb7-b6c5-65171c64ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC086170D0>]}
2021-06-23 05:35:54.570561 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bde423a-b59a-4eb7-b6c5-65171c64ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC08506850>]}
2021-06-23 05:35:54.571559 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:35:54.571559 (MainThread): 
2021-06-23 05:35:54.572558 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:35:54.573582 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:35:54.573582 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:35:55.480456 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:35:55.480741 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:35:55.497695 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:35:56.389322 (MainThread): 17:35:56 | Concurrency: 1 threads (target='dev')
2021-06-23 05:35:56.389322 (MainThread): 17:35:56 | 
2021-06-23 05:35:56.397235 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:35:56.397235 (Thread-1): 17:35:56 | 1 of 1 START view model dbt_petershi.customers....................... [RUN]
2021-06-23 05:35:56.397715 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:35:56.397715 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:35:56.400743 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:35:56.400743 (Thread-1): finished collecting timing info
2021-06-23 05:35:56.454577 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:35:56.455581 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:35:56.459534 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
  OPTIONS()
  as 

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-06-23 05:35:58.607549 (Thread-1): finished collecting timing info
2021-06-23 05:35:58.607549 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bde423a-b59a-4eb7-b6c5-65171c64ee12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0860AEB0>]}
2021-06-23 05:35:58.607549 (Thread-1): 17:35:58 | 1 of 1 OK created view model dbt_petershi.customers.................. [OK in 2.21s]
2021-06-23 05:35:58.607549 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:35:58.607549 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:35:58.607549 (MainThread): 17:35:58 | 
2021-06-23 05:35:58.607549 (MainThread): 17:35:58 | Finished running 1 view model in 4.03s.
2021-06-23 05:35:58.607549 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:35:58.607549 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:35:58.607549 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 05:35:58.607549 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-23 05:35:58.607549 (MainThread): unclosed <ssl.SSLSocket fd=1052, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49295), raddr=('172.217.167.74', 443)>
2021-06-23 05:35:58.607549 (MainThread): unclosed <ssl.SSLSocket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 49296), raddr=('142.250.66.202', 443)>
2021-06-23 05:35:58.624862 (MainThread): 
2021-06-23 05:35:58.624862 (MainThread): Completed successfully
2021-06-23 05:35:58.625835 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-23 05:35:58.625835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC085D5D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0860AE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC0860AFA0>]}
2021-06-23 05:35:58.625835 (MainThread): Flushing usage events
2021-06-23 05:41:03.470330 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:41:03.800593 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:41:03.800593 (MainThread): Tracking: tracking
2021-06-23 05:41:03.800593 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5E5986A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5F1C6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5F1C6DF0>]}
2021-06-23 05:41:03.816247 (MainThread): Partial parsing not enabled
2021-06-23 05:41:03.822789 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:41:03.838448 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:41:03.838448 (MainThread): Parsing macros\etc.sql
2021-06-23 05:41:03.854069 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:41:03.854069 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:41:03.854069 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:41:03.870748 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:41:03.870748 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:41:03.870748 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:41:03.870748 (MainThread): Parsing macros\core.sql
2021-06-23 05:41:03.870748 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:41:03.923126 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:41:03.923126 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:41:03.923126 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:41:03.923126 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:41:03.923126 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:41:03.923126 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:41:03.923126 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:41:03.938751 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:41:03.938751 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:41:03.954371 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:41:03.954371 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:41:03.970027 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:41:03.985650 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:41:04.016892 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:41:04.016892 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:41:04.023432 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:41:04.039092 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:41:04.039092 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:41:04.039092 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:41:04.039092 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:41:04.054713 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:41:04.054713 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:41:04.201882 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:41:04.201882 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:41:04.217472 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:41:04.224010 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5F2F4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5F2DEAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A5F2DEB20>]}
2021-06-23 05:41:04.224010 (MainThread): Flushing usage events
2021-06-23 05:41:05.091083 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-06-23 05:41:05.091083 (MainThread): Encountered an error:
2021-06-23 05:41:05.091083 (MainThread): Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_orders.' which was not found
2021-06-23 05:41:05.106343 (MainThread): Traceback (most recent call last):
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\parser\manifest.py", line 168, in get_full_manifest
    manifest = loader.load()
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\parser\manifest.py", line 302, in load
    self.process_refs(self.root_project.project_name)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\parser\manifest.py", line 625, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\parser\manifest.py", line 936, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\parser\manifest.py", line 709, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\exceptions.py", line 575, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_orders.' which was not found

2021-06-23 05:41:49.101115 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:41:49.400900 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=['customers'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:41:49.401898 (MainThread): Tracking: tracking
2021-06-23 05:41:49.409534 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F230E74C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23D16310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23D16130>]}
2021-06-23 05:41:49.417488 (MainThread): Partial parsing not enabled
2021-06-23 05:41:49.432448 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:41:49.448406 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:41:49.453392 (MainThread): Parsing macros\etc.sql
2021-06-23 05:41:49.454390 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:41:49.458379 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:41:49.468353 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:41:49.470347 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:41:49.472342 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:41:49.480321 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:41:49.482316 (MainThread): Parsing macros\core.sql
2021-06-23 05:41:49.485308 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:41:49.525203 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:41:49.533182 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:41:49.533182 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:41:49.535177 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:41:49.536174 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:41:49.537171 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:41:49.538169 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:41:49.547145 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:41:49.553129 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:41:49.564100 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:41:49.566094 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:41:49.574073 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:41:49.592025 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:41:49.617956 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:41:49.619951 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:41:49.634912 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:41:49.640895 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:41:49.644886 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:41:49.650869 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:41:49.652864 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:41:49.653861 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:41:49.654859 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:41:49.809447 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:41:49.817426 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:41:49.819421 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:41:49.838371 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6780413d-2e68-40b0-983e-d4b50bac03b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23E48A00>]}
2021-06-23 05:41:49.841363 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6780413d-2e68-40b0-983e-d4b50bac03b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23D06CD0>]}
2021-06-23 05:41:49.842361 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:41:49.842361 (MainThread): 
2021-06-23 05:41:49.843358 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:41:49.844353 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:41:49.844353 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:41:50.968204 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:41:50.968204 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:41:50.972226 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:41:51.847622 (MainThread): 17:41:51 | Concurrency: 1 threads (target='dev')
2021-06-23 05:41:51.848633 (MainThread): 17:41:51 | 
2021-06-23 05:41:51.856318 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:41:51.856318 (Thread-1): 17:41:51 | 1 of 1 START view model dbt_petershi.customers....................... [RUN]
2021-06-23 05:41:51.856837 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:41:51.856837 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:41:51.858868 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:41:51.859866 (Thread-1): finished collecting timing info
2021-06-23 05:41:51.916706 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:41:51.917716 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:41:51.921665 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
  OPTIONS()
  as 

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-06-23 05:41:54.305246 (Thread-1): finished collecting timing info
2021-06-23 05:41:54.305246 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6780413d-2e68-40b0-983e-d4b50bac03b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23D79F40>]}
2021-06-23 05:41:54.305246 (Thread-1): 17:41:54 | 1 of 1 OK created view model dbt_petershi.customers.................. [OK in 2.45s]
2021-06-23 05:41:54.306256 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:41:54.307371 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:41:54.307371 (MainThread): 17:41:54 | 
2021-06-23 05:41:54.308142 (MainThread): 17:41:54 | Finished running 1 view model in 4.46s.
2021-06-23 05:41:54.308468 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:41:54.308468 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:41:54.308468 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 05:41:54.308468 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-23 05:41:54.308468 (MainThread): unclosed <ssl.SSLSocket fd=1052, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64689), raddr=('172.217.167.74', 443)>
2021-06-23 05:41:54.309502 (MainThread): unclosed <ssl.SSLSocket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64690), raddr=('142.250.66.202', 443)>
2021-06-23 05:41:54.313496 (MainThread): 
2021-06-23 05:41:54.314454 (MainThread): Completed successfully
2021-06-23 05:41:54.314454 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-23 05:41:54.315451 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23D068E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23D79F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F23EF4C70>]}
2021-06-23 05:41:54.315451 (MainThread): Flushing usage events
2021-06-23 05:42:43.603648 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:42:43.904964 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:42:43.905961 (MainThread): Tracking: tracking
2021-06-23 05:42:43.913093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018231827760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232456310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232456130>]}
2021-06-23 05:42:43.921055 (MainThread): Partial parsing not enabled
2021-06-23 05:42:43.936015 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:42:43.951973 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:42:43.956960 (MainThread): Parsing macros\etc.sql
2021-06-23 05:42:43.957957 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:42:43.961946 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:42:43.972917 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:42:43.974912 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:42:43.975910 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:42:43.983888 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:42:43.986880 (MainThread): Parsing macros\core.sql
2021-06-23 05:42:43.989872 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:42:44.029801 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:42:44.037779 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:42:44.037779 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:42:44.039774 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:42:44.040772 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:42:44.041770 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:42:44.042766 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:42:44.051709 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:42:44.056696 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:42:44.068664 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:42:44.069662 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:42:44.078638 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:42:44.095593 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:42:44.122521 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:42:44.123518 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:42:44.138479 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:42:44.144463 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:42:44.148452 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:42:44.154436 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:42:44.156431 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:42:44.157428 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:42:44.158426 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:42:44.314046 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:42:44.323021 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:42:44.325016 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:42:44.342961 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcd905d3-6e9d-44dc-a683-2210c5df38d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182325590D0>]}
2021-06-23 05:42:44.346923 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcd905d3-6e9d-44dc-a683-2210c5df38d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232445490>]}
2021-06-23 05:42:44.346923 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:42:44.347922 (MainThread): 
2021-06-23 05:42:44.347922 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:42:44.349915 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:42:44.349915 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:42:45.236708 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:42:45.236708 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:42:45.252071 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:42:46.126123 (MainThread): 17:42:46 | Concurrency: 1 threads (target='dev')
2021-06-23 05:42:46.126123 (MainThread): 17:42:46 | 
2021-06-23 05:42:46.134350 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-23 05:42:46.134350 (Thread-1): 17:42:46 | 1 of 3 START view model dbt_petershi.stg_customers................... [RUN]
2021-06-23 05:42:46.134856 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:42:46.134856 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-23 05:42:46.136889 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 05:42:46.136889 (Thread-1): finished collecting timing info
2021-06-23 05:42:46.188715 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 05:42:46.189746 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:42:46.193737 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-06-23 05:42:48.409282 (Thread-1): finished collecting timing info
2021-06-23 05:42:48.410278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd905d3-6e9d-44dc-a683-2210c5df38d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823238FAF0>]}
2021-06-23 05:42:48.410278 (Thread-1): 17:42:48 | 1 of 3 OK created view model dbt_petershi.stg_customers.............. [OK in 2.28s]
2021-06-23 05:42:48.411543 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-23 05:42:48.411543 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-23 05:42:48.411543 (Thread-1): 17:42:48 | 2 of 3 START view model dbt_petershi.stg_orders...................... [RUN]
2021-06-23 05:42:48.411543 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:42:48.411543 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-23 05:42:48.412580 (Thread-1): unclosed <ssl.SSLSocket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64697), raddr=('172.217.167.74', 443)>
2021-06-23 05:42:48.412580 (Thread-1): unclosed <ssl.SSLSocket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64698), raddr=('142.250.66.202', 443)>
2021-06-23 05:42:48.413587 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 05:42:48.413587 (Thread-1): finished collecting timing info
2021-06-23 05:42:48.417532 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 05:42:48.418080 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:42:48.421536 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2021-06-23 05:42:50.642854 (Thread-1): finished collecting timing info
2021-06-23 05:42:50.643851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd905d3-6e9d-44dc-a683-2210c5df38d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823239BF40>]}
2021-06-23 05:42:50.643851 (Thread-1): 17:42:50 | 2 of 3 OK created view model dbt_petershi.stg_orders................. [OK in 2.23s]
2021-06-23 05:42:50.645100 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-23 05:42:50.645616 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:42:50.645616 (Thread-1): 17:42:50 | 3 of 3 START view model dbt_petershi.customers....................... [RUN]
2021-06-23 05:42:50.645616 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:42:50.645616 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:42:50.646643 (Thread-1): unclosed <ssl.SSLSocket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64699), raddr=('172.217.167.74', 443)>
2021-06-23 05:42:50.646643 (Thread-1): unclosed <ssl.SSLSocket fd=772, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64700), raddr=('142.250.66.202', 443)>
2021-06-23 05:42:50.648610 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:42:50.649634 (Thread-1): finished collecting timing info
2021-06-23 05:42:50.652619 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:42:50.653616 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:42:50.657587 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
  OPTIONS()
  as 

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,,

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-06-23 05:42:51.573698 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got "," at [25:45]')
2021-06-23 05:42:52.645466 (Thread-1): finished collecting timing info
2021-06-23 05:42:52.645466 (Thread-1): Database Error in model customers (models\customers.sql)
  Syntax error: Expected ")" but got "," at [25:45]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    yield
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 542, in _retry_and_handle
    return retry.retry_target(
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\google\api_core\retry.py", line 188, in retry_target
    return target()
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 335, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 528, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\google\cloud\bigquery\job\query.py", line 1266, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\google\cloud\bigquery\job\base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\google\api_core\future\polling.py", line 134, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected ")" but got "," at [25:45]

(job ID: 4a8b6f06-a40b-471c-89c0-53ab1ff17110)

                                                          -----Query Job SQL Follows-----                                                           

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
   5:  OPTIONS()
   6:  as 
   7:
   8:with customers as (
   9:    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
  10:),
  11:
  12:orders as (
  13:
  14:select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`
  15:
  16:),
  17:
  18:customer_orders as (
  19:
  20:    select
  21:        customer_id,
  22:
  23:        min(order_date) as first_order_date,
  24:        max(order_date) as most_recent_order_date,
  25:        count(order_id) as number_of_orders,,
  26:
  27:    from orders
  28:
  29:    group by 1
  30:
  31:),
  32:
  33:
  34:final as (
  35:
  36:    select
  37:        customers.customer_id,
  38:        customers.first_name,
  39:        customers.last_name,
  40:        customer_orders.first_order_date,
  41:        customer_orders.most_recent_order_date,
  42:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  43:
  44:    from customers
  45:
  46:    left join customer_orders using (customer_id)
  47:
  48:)
  49:
  50:select * from final;
  51:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\task\run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\clients\jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\clients\jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    return self.connections.execute(
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 346, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 337, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 542, in _retry_and_handle
    return retry.retry_target(
  File "c:\python39\lib\contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 157, in exception_handler
    self.handle_error(e, message)
  File "c:\users\peter.shi\.virtualenvs\dbt-oefho6hz\lib\site-packages\dbt\adapters\bigquery\connections.py", line 145, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Syntax error: Expected ")" but got "," at [25:45]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2021-06-23 05:42:52.723132 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcd905d3-6e9d-44dc-a683-2210c5df38d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182324C6F10>]}
2021-06-23 05:42:52.723132 (Thread-1): 17:42:52 | 3 of 3 ERROR creating view model dbt_petershi.customers.............. [ERROR in 2.08s]
2021-06-23 05:42:52.724737 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:42:52.725299 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:42:52.726306 (MainThread): 17:42:52 | 
2021-06-23 05:42:52.726777 (MainThread): 17:42:52 | Finished running 3 view models in 8.38s.
2021-06-23 05:42:52.727246 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:42:52.727246 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:42:52.727246 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 05:42:52.727246 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-23 05:42:52.731239 (MainThread): 
2021-06-23 05:42:52.731239 (MainThread): Completed with 1 error and 0 warnings:
2021-06-23 05:42:52.732236 (MainThread): 
2021-06-23 05:42:52.732236 (MainThread): Database Error in model customers (models\customers.sql)
2021-06-23 05:42:52.734240 (MainThread):   Syntax error: Expected ")" but got "," at [25:45]
2021-06-23 05:42:52.734240 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2021-06-23 05:42:52.734240 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-06-23 05:42:52.735227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182325198B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018232522AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001823237D5B0>]}
2021-06-23 05:42:52.735227 (MainThread): Flushing usage events
2021-06-23 05:43:25.228215 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:43:25.529408 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 05:43:25.529408 (MainThread): Tracking: tracking
2021-06-23 05:43:25.537419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A01D277C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02A96670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02A96DC0>]}
2021-06-23 05:43:25.545398 (MainThread): Partial parsing not enabled
2021-06-23 05:43:25.559361 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:43:25.575319 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:43:25.580305 (MainThread): Parsing macros\etc.sql
2021-06-23 05:43:25.582300 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:43:25.585292 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:43:25.596263 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:43:25.598258 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:43:25.599255 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:43:25.607234 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:43:25.610226 (MainThread): Parsing macros\core.sql
2021-06-23 05:43:25.613218 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:43:25.652114 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:43:25.660093 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:43:25.660093 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:43:25.662088 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:43:25.663085 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:43:25.664083 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:43:25.665080 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:43:25.674056 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:43:25.679043 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:43:25.691011 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:43:25.693006 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:43:25.700984 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:43:25.718443 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:43:25.744878 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:43:25.746873 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:43:25.760835 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:43:25.766854 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:43:25.770843 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:43:25.777825 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:43:25.778822 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:43:25.779820 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:43:25.781815 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:43:25.934406 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:43:25.942421 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:43:25.944409 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:43:25.962334 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abf54df0-c9be-4578-96db-5c84694c8206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02BBE0D0>]}
2021-06-23 05:43:25.966324 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abf54df0-c9be-4578-96db-5c84694c8206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02A85DC0>]}
2021-06-23 05:43:25.966324 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:43:25.967321 (MainThread): 
2021-06-23 05:43:25.968318 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:43:25.969316 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 05:43:25.969316 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:43:26.840798 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:43:26.840798 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:43:26.844789 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:43:27.727125 (MainThread): 17:43:27 | Concurrency: 1 threads (target='dev')
2021-06-23 05:43:27.727414 (MainThread): 17:43:27 | 
2021-06-23 05:43:27.752352 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-23 05:43:27.752352 (Thread-1): 17:43:27 | 1 of 3 START view model dbt_petershi.stg_customers................... [RUN]
2021-06-23 05:43:27.753307 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:43:27.753307 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-23 05:43:27.754305 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 05:43:27.755303 (Thread-1): finished collecting timing info
2021-06-23 05:43:27.808192 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 05:43:27.809190 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:43:27.813181 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-06-23 05:43:29.949042 (Thread-1): finished collecting timing info
2021-06-23 05:43:29.949042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abf54df0-c9be-4578-96db-5c84694c8206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02B265B0>]}
2021-06-23 05:43:29.949042 (Thread-1): 17:43:29 | 1 of 3 OK created view model dbt_petershi.stg_customers.............. [OK in 2.20s]
2021-06-23 05:43:29.950587 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-23 05:43:29.950587 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-23 05:43:29.950587 (Thread-1): 17:43:29 | 2 of 3 START view model dbt_petershi.stg_orders...................... [RUN]
2021-06-23 05:43:29.950587 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:43:29.950587 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-23 05:43:29.951621 (Thread-1): unclosed <ssl.SSLSocket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64712), raddr=('172.217.167.74', 443)>
2021-06-23 05:43:29.951621 (Thread-1): unclosed <ssl.SSLSocket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64713), raddr=('142.250.66.202', 443)>
2021-06-23 05:43:29.952618 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 05:43:29.952618 (Thread-1): finished collecting timing info
2021-06-23 05:43:29.955575 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 05:43:29.956612 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:43:29.960597 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2021-06-23 05:43:32.089296 (Thread-1): finished collecting timing info
2021-06-23 05:43:32.090286 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abf54df0-c9be-4578-96db-5c84694c8206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A029DCFD0>]}
2021-06-23 05:43:32.090286 (Thread-1): 17:43:32 | 2 of 3 OK created view model dbt_petershi.stg_orders................. [OK in 2.14s]
2021-06-23 05:43:32.091568 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-23 05:43:32.091568 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:43:32.091568 (Thread-1): 17:43:32 | 3 of 3 START view model dbt_petershi.customers....................... [RUN]
2021-06-23 05:43:32.092567 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:43:32.092567 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:43:32.092567 (Thread-1): unclosed <ssl.SSLSocket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64714), raddr=('172.217.167.74', 443)>
2021-06-23 05:43:32.092567 (Thread-1): unclosed <ssl.SSLSocket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64715), raddr=('142.250.66.202', 443)>
2021-06-23 05:43:32.094562 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:43:32.095559 (Thread-1): finished collecting timing info
2021-06-23 05:43:32.098551 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 05:43:32.099548 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:43:32.103537 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`customers`
  OPTIONS()
  as 

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2021-06-23 05:43:34.298503 (Thread-1): finished collecting timing info
2021-06-23 05:43:34.299499 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abf54df0-c9be-4578-96db-5c84694c8206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02B7F5B0>]}
2021-06-23 05:43:34.299499 (Thread-1): 17:43:34 | 3 of 3 OK created view model dbt_petershi.customers.................. [OK in 2.21s]
2021-06-23 05:43:34.300463 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:43:34.301460 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:43:34.301460 (MainThread): 17:43:34 | 
2021-06-23 05:43:34.302230 (MainThread): 17:43:34 | Finished running 3 view models in 8.33s.
2021-06-23 05:43:34.302230 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:43:34.302230 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 05:43:34.302230 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 05:43:34.302230 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-23 05:43:34.303264 (MainThread): unclosed <ssl.SSLSocket fd=736, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64716), raddr=('172.217.167.74', 443)>
2021-06-23 05:43:34.303264 (MainThread): unclosed <ssl.SSLSocket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 64717), raddr=('142.250.66.202', 443)>
2021-06-23 05:43:34.308250 (MainThread): 
2021-06-23 05:43:34.308250 (MainThread): Completed successfully
2021-06-23 05:43:34.309113 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-23 05:43:34.309113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02B7C220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02B57D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A02B265B0>]}
2021-06-23 05:43:34.309113 (MainThread): Flushing usage events
2021-06-23 05:48:24.207038 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:48:24.505665 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2021-06-23 05:48:24.505665 (MainThread): Tracking: tracking
2021-06-23 05:48:24.505665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022128E97760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022129AC7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022129AC7F70>]}
2021-06-23 05:48:24.521309 (MainThread): Partial parsing not enabled
2021-06-23 05:48:24.536937 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:48:24.552558 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:48:24.552558 (MainThread): Parsing macros\etc.sql
2021-06-23 05:48:24.552558 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:48:24.568180 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:48:24.568180 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:48:24.568180 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:48:24.568180 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:48:24.583811 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:48:24.583811 (MainThread): Parsing macros\core.sql
2021-06-23 05:48:24.583811 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:48:24.628403 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:48:24.628403 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:48:24.628403 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:48:24.644061 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:48:24.644061 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:48:24.644061 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:48:24.644061 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:48:24.644061 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:48:24.659682 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:48:24.659682 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:48:24.675303 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:48:24.675303 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:48:24.690929 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:48:24.721630 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:48:24.721630 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:48:24.737255 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:48:24.752873 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:48:24.752873 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:48:24.752873 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:48:24.752873 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:48:24.752873 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:48:24.752873 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:48:24.918366 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:48:24.928442 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:48:24.928442 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:48:24.948634 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.956709 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.958824 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.958824 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.958824 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.958824 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.969056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.969056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.969056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.985429 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:24.985429 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:48:25.019755 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9f75ab9-99e1-43a3-9dd6-5e4dde44df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022129B89EE0>]}
2021-06-23 05:48:25.029849 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9f75ab9-99e1-43a3-9dd6-5e4dde44df72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022129B89EE0>]}
2021-06-23 05:48:25.029849 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:48:25.029849 (MainThread): 
2021-06-23 05:48:25.029849 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:48:25.029849 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:48:25.029849 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:48:25.037936 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:48:26.093984 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi_dbt_test__audit".
2021-06-23 05:48:26.093984 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-23 05:48:26.109023 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:48:27.228692 (MainThread): 17:48:27 | Concurrency: 1 threads (target='dev')
2021-06-23 05:48:27.228692 (MainThread): 17:48:27 | 
2021-06-23 05:48:27.228692 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f
2021-06-23 05:48:27.228692 (Thread-1): 17:48:27 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-06-23 05:48:27.228692 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f".
2021-06-23 05:48:27.228692 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f
2021-06-23 05:48:27.228692 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f"
2021-06-23 05:48:27.252636 (Thread-1): finished collecting timing info
2021-06-23 05:48:27.268295 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f"
2021-06-23 05:48:27.268295 (Thread-1): Opening a new connection, currently in state init
2021-06-23 05:48:27.268295 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from `silent-caster-317703`.`dbt_petershi`.`stg_orders`
    group by 1

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-06-23 05:48:31.023678 (Thread-1): finished collecting timing info
2021-06-23 05:48:31.023678 (Thread-1): 17:48:31 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 3.79s]
2021-06-23 05:48:31.023678 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f
2021-06-23 05:48:31.023678 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.923d2d910a
2021-06-23 05:48:31.023678 (Thread-1): 17:48:31 | 2 of 9 START test not_null_customers_customer_id..................... [RUN]
2021-06-23 05:48:31.023678 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.923d2d910a".
2021-06-23 05:48:31.023678 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.923d2d910a
2021-06-23 05:48:31.023678 (Thread-1): unclosed <ssl.SSLSocket fd=356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54273), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:31.023678 (Thread-1): unclosed <ssl.SSLSocket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54274), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:31.023678 (Thread-1): unclosed <ssl.SSLSocket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54278), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:31.023678 (Thread-1): unclosed <ssl.SSLSocket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54277), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:31.039336 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.923d2d910a"
2021-06-23 05:48:31.039336 (Thread-1): finished collecting timing info
2021-06-23 05:48:31.039336 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_customers_customer_id.923d2d910a"
2021-06-23 05:48:31.039336 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:31.039336 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id.923d2d910a: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.923d2d910a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `silent-caster-317703`.`dbt_petershi`.`customers`
where customer_id is null



      
    ) dbt_internal_test
2021-06-23 05:48:34.135424 (Thread-1): finished collecting timing info
2021-06-23 05:48:34.135424 (Thread-1): 17:48:34 | 2 of 9 PASS not_null_customers_customer_id........................... [PASS in 3.11s]
2021-06-23 05:48:34.135424 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.923d2d910a
2021-06-23 05:48:34.135424 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1
2021-06-23 05:48:34.135424 (Thread-1): 17:48:34 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-23 05:48:34.135424 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1".
2021-06-23 05:48:34.135424 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1
2021-06-23 05:48:34.135424 (Thread-1): unclosed <ssl.SSLSocket fd=1036, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54279), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:34.135424 (Thread-1): unclosed <ssl.SSLSocket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54280), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:34.135424 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1"
2021-06-23 05:48:34.135424 (Thread-1): finished collecting timing info
2021-06-23 05:48:34.135424 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1"
2021-06-23 05:48:34.135424 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:34.151074 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
2021-06-23 05:48:37.036270 (Thread-1): finished collecting timing info
2021-06-23 05:48:37.036270 (Thread-1): 17:48:37 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 2.90s]
2021-06-23 05:48:37.036270 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1
2021-06-23 05:48:37.036270 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id.765995d759
2021-06-23 05:48:37.036270 (Thread-1): 17:48:37 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2021-06-23 05:48:37.036270 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id.765995d759".
2021-06-23 05:48:37.036270 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id.765995d759
2021-06-23 05:48:37.036270 (Thread-1): unclosed <ssl.SSLSocket fd=964, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54281), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:37.036270 (Thread-1): unclosed <ssl.SSLSocket fd=1036, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54282), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:37.042774 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.765995d759"
2021-06-23 05:48:37.042774 (Thread-1): finished collecting timing info
2021-06-23 05:48:37.042774 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.765995d759"
2021-06-23 05:48:37.042774 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:37.042774 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id.765995d759: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.765995d759"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `silent-caster-317703`.`dbt_petershi`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
2021-06-23 05:48:39.596995 (Thread-1): finished collecting timing info
2021-06-23 05:48:39.596995 (Thread-1): 17:48:39 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 2.56s]
2021-06-23 05:48:39.596995 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.765995d759
2021-06-23 05:48:39.596995 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90
2021-06-23 05:48:39.596995 (Thread-1): 17:48:39 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2021-06-23 05:48:39.596995 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90".
2021-06-23 05:48:39.596995 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90
2021-06-23 05:48:39.596995 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90"
2021-06-23 05:48:39.596995 (Thread-1): finished collecting timing info
2021-06-23 05:48:39.596995 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90"
2021-06-23 05:48:39.596995 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:39.612332 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `silent-caster-317703`.`dbt_petershi`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
2021-06-23 05:48:42.456778 (Thread-1): finished collecting timing info
2021-06-23 05:48:42.456778 (Thread-1): 17:48:42 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 2.86s]
2021-06-23 05:48:42.458800 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90
2021-06-23 05:48:42.458800 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c
2021-06-23 05:48:42.458800 (Thread-1): 17:48:42 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2021-06-23 05:48:42.458800 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c".
2021-06-23 05:48:42.458800 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c
2021-06-23 05:48:42.463824 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c"
2021-06-23 05:48:42.464821 (Thread-1): finished collecting timing info
2021-06-23 05:48:42.465817 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c"
2021-06-23 05:48:42.466814 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:42.467901 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    child.customer_id

from `silent-caster-317703`.`dbt_petershi`.`stg_orders` as child

left join `silent-caster-317703`.`dbt_petershi`.`stg_customers` as parent
    on child.customer_id = parent.customer_id

where child.customer_id is not null
  and parent.customer_id is null



      
    ) dbt_internal_test
2021-06-23 05:48:45.317188 (Thread-1): finished collecting timing info
2021-06-23 05:48:45.317188 (Thread-1): 17:48:45 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 2.86s]
2021-06-23 05:48:45.317188 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.bcbdd9092c
2021-06-23 05:48:45.317188 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.d48e126d80
2021-06-23 05:48:45.317188 (Thread-1): 17:48:45 | 7 of 9 START test unique_customers_customer_id....................... [RUN]
2021-06-23 05:48:45.317188 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.d48e126d80".
2021-06-23 05:48:45.317188 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.d48e126d80
2021-06-23 05:48:45.317188 (Thread-1): unclosed <ssl.SSLSocket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54287), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:45.317188 (Thread-1): unclosed <ssl.SSLSocket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54288), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:45.317188 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.d48e126d80"
2021-06-23 05:48:45.317188 (Thread-1): finished collecting timing info
2021-06-23 05:48:45.317188 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_customers_customer_id.d48e126d80"
2021-06-23 05:48:45.317188 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:45.332630 (Thread-1): On test.jaffle_shop.unique_customers_customer_id.d48e126d80: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.d48e126d80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id,
    count(*) as n_records

from `silent-caster-317703`.`dbt_petershi`.`customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-06-23 05:48:48.684745 (Thread-1): finished collecting timing info
2021-06-23 05:48:48.684745 (Thread-1): 17:48:48 | 7 of 9 PASS unique_customers_customer_id............................. [PASS in 3.37s]
2021-06-23 05:48:48.684745 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.d48e126d80
2021-06-23 05:48:48.684745 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.5530022331
2021-06-23 05:48:48.684745 (Thread-1): 17:48:48 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2021-06-23 05:48:48.684745 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.5530022331".
2021-06-23 05:48:48.684745 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.5530022331
2021-06-23 05:48:48.684745 (Thread-1): unclosed <ssl.SSLSocket fd=976, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54284), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:48.684745 (Thread-1): unclosed <ssl.SSLSocket fd=964, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54283), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:48.684745 (Thread-1): unclosed <ssl.SSLSocket fd=1120, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54286), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:48.684745 (Thread-1): unclosed <ssl.SSLSocket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54285), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:48.684745 (Thread-1): unclosed <ssl.SSLSocket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54289), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:48.684745 (Thread-1): unclosed <ssl.SSLSocket fd=580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54290), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:48.684745 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.5530022331"
2021-06-23 05:48:48.684745 (Thread-1): finished collecting timing info
2021-06-23 05:48:48.705063 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.5530022331"
2021-06-23 05:48:48.706060 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:48.710077 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id.5530022331: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.5530022331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id,
    count(*) as n_records

from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-06-23 05:48:51.688965 (Thread-1): finished collecting timing info
2021-06-23 05:48:51.688965 (Thread-1): 17:48:51 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 3.00s]
2021-06-23 05:48:51.688965 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.5530022331
2021-06-23 05:48:51.688965 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48
2021-06-23 05:48:51.688965 (Thread-1): 17:48:51 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2021-06-23 05:48:51.688965 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48".
2021-06-23 05:48:51.688965 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48
2021-06-23 05:48:51.688965 (Thread-1): unclosed <ssl.SSLSocket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54291), raddr=('142.250.66.170', 443)>
2021-06-23 05:48:51.688965 (Thread-1): unclosed <ssl.SSLSocket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 54292), raddr=('142.250.66.202', 443)>
2021-06-23 05:48:51.688965 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48"
2021-06-23 05:48:51.688965 (Thread-1): finished collecting timing info
2021-06-23 05:48:51.688965 (Thread-1): Writing runtime SQL for node "test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48"
2021-06-23 05:48:51.688965 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 05:48:51.704591 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id,
    count(*) as n_records

from `silent-caster-317703`.`dbt_petershi`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-06-23 05:48:54.541883 (Thread-1): finished collecting timing info
2021-06-23 05:48:54.541883 (Thread-1): 17:48:54 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 2.85s]
2021-06-23 05:48:54.541883 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48
2021-06-23 05:48:54.541883 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:48:54.541883 (MainThread): 17:48:54 | 
2021-06-23 05:48:54.541883 (MainThread): 17:48:54 | Finished running 9 tests in 29.51s.
2021-06-23 05:48:54.541883 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:48:54.541883 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi_dbt_test__audit' was properly closed.
2021-06-23 05:48:54.557504 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48' was properly closed.
2021-06-23 05:48:54.557504 (MainThread): 
2021-06-23 05:48:54.557504 (MainThread): Completed successfully
2021-06-23 05:48:54.557504 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2021-06-23 05:48:54.557504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022129CE6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022129CAE5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022129B0CAF0>]}
2021-06-23 05:48:54.557504 (MainThread): Flushing usage events
2021-06-23 05:57:46.881644 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:57:47.270661 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, compile=True, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
2021-06-23 05:57:47.270661 (MainThread): Tracking: tracking
2021-06-23 05:57:47.278187 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ABDD7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ACA06670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ACA06E20>]}
2021-06-23 05:57:47.286165 (MainThread): Partial parsing not enabled
2021-06-23 05:57:47.302122 (MainThread): Parsing macros\adapters.sql
2021-06-23 05:57:47.318079 (MainThread): Parsing macros\catalog.sql
2021-06-23 05:57:47.323066 (MainThread): Parsing macros\etc.sql
2021-06-23 05:57:47.324063 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 05:57:47.328053 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 05:57:47.338026 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 05:57:47.340021 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 05:57:47.341018 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 05:57:47.348997 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 05:57:47.351989 (MainThread): Parsing macros\core.sql
2021-06-23 05:57:47.354981 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 05:57:47.394914 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 05:57:47.401895 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 05:57:47.402888 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 05:57:47.403885 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 05:57:47.404882 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 05:57:47.406877 (MainThread): Parsing macros\etc\query.sql
2021-06-23 05:57:47.407875 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 05:57:47.415853 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 05:57:47.421837 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 05:57:47.433806 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 05:57:47.434803 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 05:57:47.442781 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 05:57:47.460699 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 05:57:47.486630 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 05:57:47.487627 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 05:57:47.502587 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 05:57:47.508571 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 05:57:47.513558 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 05:57:47.518544 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 05:57:47.520539 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 05:57:47.521537 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 05:57:47.523531 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 05:57:47.676127 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:57:47.685102 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:57:47.687096 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:57:47.711032 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.713027 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.714025 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.716019 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.718014 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.719011 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.728985 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.728985 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 05:57:47.770871 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '313b4b8b-d842-4641-a22c-4ca2e380b57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ACAEDAC0>]}
2021-06-23 05:57:47.778850 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '313b4b8b-d842-4641-a22c-4ca2e380b57e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ACAED220>]}
2021-06-23 05:57:47.778850 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 05:57:47.779848 (MainThread): 
2021-06-23 05:57:47.779848 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 05:57:47.781855 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi_dbt_test__audit".
2021-06-23 05:57:47.781855 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 05:57:47.785831 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:57:49.018354 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 05:57:49.018354 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-23 05:57:49.022369 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 05:57:49.915879 (MainThread): 17:57:49 | Concurrency: 1 threads (target='dev')
2021-06-23 05:57:49.915879 (MainThread): 17:57:49 | 
2021-06-23 05:57:49.931205 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-23 05:57:49.931205 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 05:57:49.931205 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-23 05:57:49.931205 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 05:57:49.937749 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.937749 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.937749 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-23 05:57:49.937749 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-23 05:57:49.937749 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 05:57:49.937749 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-23 05:57:49.937749 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 05:57:49.937749 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.937749 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.937749 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-23 05:57:49.937749 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1
2021-06-23 05:57:49.937749 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1".
2021-06-23 05:57:49.937749 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1
2021-06-23 05:57:49.937749 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1"
2021-06-23 05:57:49.937749 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.937749 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.937749 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.4ab9034fe1
2021-06-23 05:57:49.937749 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id.5530022331
2021-06-23 05:57:49.937749 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id.5530022331".
2021-06-23 05:57:49.937749 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id.5530022331
2021-06-23 05:57:49.953408 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.5530022331"
2021-06-23 05:57:49.953408 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.953408 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.953408 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id.5530022331
2021-06-23 05:57:49.953408 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 05:57:49.953408 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 05:57:49.953408 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 05:57:49.953408 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 05:57:49.953408 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.953408 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.953408 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 05:57:49.953408 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f
2021-06-23 05:57:49.953408 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f".
2021-06-23 05:57:49.953408 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f
2021-06-23 05:57:49.953408 (Thread-1): unclosed <ssl.SSLSocket fd=924, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 59029), raddr=('142.250.66.170', 443)>
2021-06-23 05:57:49.953408 (Thread-1): unclosed <ssl.SSLSocket fd=648, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 59030), raddr=('142.250.66.202', 443)>
2021-06-23 05:57:49.953408 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f"
2021-06-23 05:57:49.953408 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.953408 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.953408 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.1b7358ad3f
2021-06-23 05:57:49.953408 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90
2021-06-23 05:57:49.953408 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90".
2021-06-23 05:57:49.953408 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90
2021-06-23 05:57:49.968995 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90"
2021-06-23 05:57:49.968995 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.968995 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.968995 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id.052f14ae90
2021-06-23 05:57:49.968995 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48
2021-06-23 05:57:49.968995 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48".
2021-06-23 05:57:49.968995 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48
2021-06-23 05:57:49.968995 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48"
2021-06-23 05:57:49.968995 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.968995 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.968995 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id.99e62d7d48
2021-06-23 05:57:49.968995 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id.923d2d910a
2021-06-23 05:57:49.968995 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id.923d2d910a".
2021-06-23 05:57:49.968995 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id.923d2d910a
2021-06-23 05:57:49.968995 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.923d2d910a"
2021-06-23 05:57:49.984616 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.984616 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.984616 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id.923d2d910a
2021-06-23 05:57:49.984616 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id.d48e126d80
2021-06-23 05:57:49.984616 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id.d48e126d80".
2021-06-23 05:57:49.984616 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id.d48e126d80
2021-06-23 05:57:49.984616 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.d48e126d80"
2021-06-23 05:57:49.984616 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.984616 (Thread-1): finished collecting timing info
2021-06-23 05:57:49.984616 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id.d48e126d80
2021-06-23 05:57:49.984616 (MainThread): Connection 'master' was properly closed.
2021-06-23 05:57:49.984616 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 05:57:49.984616 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id.d48e126d80' was properly closed.
2021-06-23 05:57:49.984616 (MainThread): 17:57:49 | Done.
2021-06-23 05:57:50.138321 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-23 05:57:50.138321 (MainThread): 17:57:50 | Building catalog
2021-06-23 05:57:50.141100 (MainThread): Opening a new connection, currently in state init
2021-06-23 05:57:51.034288 (MainThread): Skipping catalog for silent-caster-317703.dbt_petershi_dbt_test__audit - schema does not exist
2021-06-23 05:57:51.034288 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "silent-caster-317703.information_schema".
2021-06-23 05:57:51.040327 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 05:57:51.040327 (ThreadPoolExecutor-1_0): On silent-caster-317703.information_schema: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "silent-caster-317703.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `silent-caster-317703`.`dbt_petershi`.__TABLES__
        where (upper(dataset_id) = upper('dbt_petershi'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `silent-caster-317703`.`dbt_petershi`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `silent-caster-317703`.`dbt_petershi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-23 05:57:55.295481 (MainThread): 17:57:55 | Catalog written to C:\Projects\dbt\jaffle-shop\target\catalog.json
2021-06-23 05:57:55.295481 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ABDD7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ACAF6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268ACB39A00>]}
2021-06-23 05:57:55.296477 (MainThread): Flushing usage events
2021-06-23 05:57:56.132496 (MainThread): Connection 'generate_catalog' was properly closed.
2021-06-23 05:57:56.132496 (MainThread): Connection 'silent-caster-317703.information_schema' was properly closed.
2021-06-23 05:58:24.812186 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 05:58:25.106192 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
2021-06-23 05:58:25.107190 (MainThread): Tracking: tracking
2021-06-23 05:58:25.114139 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54C837910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54D477CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C54D477E20>]}
2021-06-23 05:58:25.116133 (MainThread): Serving docs at 0.0.0.0:8080
2021-06-23 05:58:25.116133 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-06-23 05:58:25.117131 (MainThread): Press Ctrl+C to exit.


2021-06-23 06:13:22.233746 (MainThread): Flushing usage events
2021-06-23 06:13:23.107779 (MainThread): ctrl-c
2021-06-23 06:18:49.562887 (MainThread): Running with dbt=0.20.0-rc1
2021-06-23 06:18:49.848092 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, models=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2021-06-23 06:18:49.863712 (MainThread): Tracking: tracking
2021-06-23 06:18:49.863712 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7B337910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7BF66670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7BF66C70>]}
2021-06-23 06:18:49.879325 (MainThread): Partial parsing not enabled
2021-06-23 06:18:49.894945 (MainThread): Parsing macros\adapters.sql
2021-06-23 06:18:49.901475 (MainThread): Parsing macros\catalog.sql
2021-06-23 06:18:49.901475 (MainThread): Parsing macros\etc.sql
2021-06-23 06:18:49.917125 (MainThread): Parsing macros\materializations\copy.sql
2021-06-23 06:18:49.917125 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-23 06:18:49.917125 (MainThread): Parsing macros\materializations\seed.sql
2021-06-23 06:18:49.932754 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-23 06:18:49.932754 (MainThread): Parsing macros\materializations\table.sql
2021-06-23 06:18:49.932754 (MainThread): Parsing macros\materializations\view.sql
2021-06-23 06:18:49.932754 (MainThread): Parsing macros\core.sql
2021-06-23 06:18:49.948374 (MainThread): Parsing macros\adapters\common.sql
2021-06-23 06:18:49.995244 (MainThread): Parsing macros\etc\datetime.sql
2021-06-23 06:18:50.001781 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-23 06:18:50.001781 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-23 06:18:50.001781 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-23 06:18:50.001781 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-23 06:18:50.001781 (MainThread): Parsing macros\etc\query.sql
2021-06-23 06:18:50.001781 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-23 06:18:50.017438 (MainThread): Parsing macros\materializations\test.sql
2021-06-23 06:18:50.017438 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-23 06:18:50.033060 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-23 06:18:50.033060 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-23 06:18:50.033060 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-23 06:18:50.048683 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-23 06:18:50.079924 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-23 06:18:50.079924 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-23 06:18:50.104284 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-23 06:18:50.104284 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-23 06:18:50.114491 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-23 06:18:50.114491 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-23 06:18:50.114491 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-23 06:18:50.122621 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-23 06:18:50.124739 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-23 06:18:50.277338 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 06:18:50.287422 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 06:18:50.287422 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 06:18:50.305753 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.315823 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.315823 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.317938 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.317938 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.317938 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.328165 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.328165 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-06-23 06:18:50.369002 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73dfbf9e-23b2-41bb-9208-b5546c254302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7BFFDF10>]}
2021-06-23 06:18:50.377027 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73dfbf9e-23b2-41bb-9208-b5546c254302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7BFFDF10>]}
2021-06-23 06:18:50.377027 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 164 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-23 06:18:50.377027 (MainThread): 
2021-06-23 06:18:50.379039 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 06:18:50.379039 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-23 06:18:50.379039 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-23 06:18:51.591393 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi_dbt_test__audit".
2021-06-23 06:18:51.591393 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-23 06:18:51.606634 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 06:18:52.662335 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-23 06:18:52.662335 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-23 06:18:52.662335 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 06:18:53.110027 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=840, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 65294), raddr=('142.250.66.170', 443)>
2021-06-23 06:18:53.110027 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 65295), raddr=('142.250.66.202', 443)>
2021-06-23 06:18:53.523071 (MainThread): 18:18:53 | Concurrency: 1 threads (target='dev')
2021-06-23 06:18:53.523071 (MainThread): 18:18:53 | 
2021-06-23 06:18:53.538331 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-23 06:18:53.538331 (Thread-1): 18:18:53 | 1 of 3 START view model dbt_petershi.stg_customers................... [RUN]
2021-06-23 06:18:53.538331 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-23 06:18:53.538331 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-23 06:18:53.538331 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 06:18:53.538331 (Thread-1): finished collecting timing info
2021-06-23 06:18:53.562923 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-23 06:18:53.562923 (Thread-1): Opening a new connection, currently in state init
2021-06-23 06:18:53.562923 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-06-23 06:18:56.081712 (Thread-1): finished collecting timing info
2021-06-23 06:18:56.081712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dfbf9e-23b2-41bb-9208-b5546c254302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7C02A280>]}
2021-06-23 06:18:56.081712 (Thread-1): 18:18:56 | 1 of 3 OK created view model dbt_petershi.stg_customers.............. [OK in 2.54s]
2021-06-23 06:18:56.081712 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-23 06:18:56.081712 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-23 06:18:56.081712 (Thread-1): 18:18:56 | 2 of 3 START view model dbt_petershi.stg_orders...................... [RUN]
2021-06-23 06:18:56.081712 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-23 06:18:56.081712 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-23 06:18:56.081712 (Thread-1): unclosed <ssl.SSLSocket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 65298), raddr=('142.250.66.170', 443)>
2021-06-23 06:18:56.081712 (Thread-1): unclosed <ssl.SSLSocket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 65299), raddr=('142.250.66.202', 443)>
2021-06-23 06:18:56.081712 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 06:18:56.081712 (Thread-1): finished collecting timing info
2021-06-23 06:18:56.098807 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-23 06:18:56.099871 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 06:18:56.102953 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2021-06-23 06:18:58.261769 (Thread-1): finished collecting timing info
2021-06-23 06:18:58.261769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dfbf9e-23b2-41bb-9208-b5546c254302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7BF2E7C0>]}
2021-06-23 06:18:58.261769 (Thread-1): 18:18:58 | 2 of 3 OK created view model dbt_petershi.stg_orders................. [OK in 2.18s]
2021-06-23 06:18:58.261769 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-23 06:18:58.261769 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-23 06:18:58.261769 (Thread-1): 18:18:58 | 3 of 3 START table model dbt_petershi.customers...................... [RUN]
2021-06-23 06:18:58.261769 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-23 06:18:58.261769 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-23 06:18:58.261769 (Thread-1): unclosed <ssl.SSLSocket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 65300), raddr=('142.250.66.170', 443)>
2021-06-23 06:18:58.261769 (Thread-1): unclosed <ssl.SSLSocket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 65301), raddr=('142.250.66.202', 443)>
2021-06-23 06:18:58.267773 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-23 06:18:58.267773 (Thread-1): finished collecting timing info
2021-06-23 06:18:58.267773 (Thread-1): Opening a new connection, currently in state closed
2021-06-23 06:18:58.283433 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 06:18:59.170451 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-23 06:18:59.834762 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-23 06:18:59.834762 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.20.0rc1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-23 06:19:03.935542 (Thread-1): finished collecting timing info
2021-06-23 06:19:03.935542 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dfbf9e-23b2-41bb-9208-b5546c254302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7C0637C0>]}
2021-06-23 06:19:03.935542 (Thread-1): 18:19:03 | 3 of 3 OK created table model dbt_petershi.customers................. [CREATE TABLE (100.0 rows, 4.3 KB processed) in 5.67s]
2021-06-23 06:19:03.935542 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-23 06:19:03.935542 (MainThread): Acquiring new bigquery connection "master".
2021-06-23 06:19:03.935542 (MainThread): 18:19:03 | 
2021-06-23 06:19:03.935542 (MainThread): 18:19:03 | Finished running 2 view models, 1 table model in 13.56s.
2021-06-23 06:19:03.935542 (MainThread): Connection 'master' was properly closed.
2021-06-23 06:19:03.935542 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-23 06:19:03.935542 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-23 06:19:03.935542 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-23 06:19:03.935542 (MainThread): 
2021-06-23 06:19:03.935542 (MainThread): Completed successfully
2021-06-23 06:19:03.935542 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-23 06:19:03.935542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7C017550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7BFB6F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD7BFB6B50>]}
2021-06-23 06:19:03.935542 (MainThread): Flushing usage events
2021-06-25 00:06:53.605954 (MainThread): Running with dbt=0.19.1
2021-06-25 00:06:53.966233 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-25 00:06:53.968675 (MainThread): Tracking: tracking
2021-06-25 00:06:53.984511 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268731FA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002686F6FC910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268731BE670>]}
2021-06-25 00:06:53.999437 (MainThread): Partial parsing not enabled
2021-06-25 00:06:54.007334 (MainThread): Parsing macros\adapters.sql
2021-06-25 00:06:54.034321 (MainThread): Parsing macros\catalog.sql
2021-06-25 00:06:54.046741 (MainThread): Parsing macros\etc.sql
2021-06-25 00:06:54.054721 (MainThread): Parsing macros\materializations\copy.sql
2021-06-25 00:06:54.064695 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-25 00:06:54.079389 (MainThread): Parsing macros\materializations\seed.sql
2021-06-25 00:06:54.090360 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-25 00:06:54.094414 (MainThread): Parsing macros\materializations\table.sql
2021-06-25 00:06:54.112237 (MainThread): Parsing macros\materializations\view.sql
2021-06-25 00:06:54.122620 (MainThread): Parsing macros\core.sql
2021-06-25 00:06:54.134503 (MainThread): Parsing macros\adapters\common.sql
2021-06-25 00:06:54.179389 (MainThread): Parsing macros\etc\datetime.sql
2021-06-25 00:06:54.193233 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-25 00:06:54.198632 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-25 00:06:54.206348 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-25 00:06:54.213964 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-25 00:06:54.220947 (MainThread): Parsing macros\etc\query.sql
2021-06-25 00:06:54.227159 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-25 00:06:54.242409 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-25 00:06:54.260327 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-25 00:06:54.268205 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-25 00:06:54.279471 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-25 00:06:54.307093 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-25 00:06:54.340008 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-25 00:06:54.351801 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-25 00:06:54.372755 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-25 00:06:54.384530 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-25 00:06:54.393747 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-25 00:06:54.406259 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-25 00:06:54.414515 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-25 00:06:54.421711 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-25 00:06:54.428751 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-25 00:06:54.434770 (MainThread): Partial parsing not enabled
2021-06-25 00:06:54.454714 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-25 00:06:54.464653 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 00:06:54.467646 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 00:06:54.475487 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-25 00:06:54.485459 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-25 00:06:54.577265 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8335c881-ccbd-41ae-a6f7-98540e79707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026873443640>]}
2021-06-25 00:06:54.582201 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8335c881-ccbd-41ae-a6f7-98540e79707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268732307C0>]}
2021-06-25 00:06:54.582201 (MainThread): Found 5 models, 11 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 00:06:54.583199 (MainThread): 
2021-06-25 00:06:54.583199 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 00:06:54.585193 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-25 00:06:54.585193 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 00:06:55.486459 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-25 00:06:55.487494 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 00:06:55.490474 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-25 00:06:56.412661 (MainThread): 12:06:56 | Concurrency: 1 threads (target='dev')
2021-06-25 00:06:56.412661 (MainThread): 12:06:56 | 
2021-06-25 00:06:56.416644 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2021-06-25 00:06:56.416644 (Thread-1): 12:06:56 | 1 of 5 START table model dbt_petershi.my_first_dbt_model............. [RUN]
2021-06-25 00:06:56.417333 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2021-06-25 00:06:56.417333 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2021-06-25 00:06:56.419332 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-25 00:06:56.420337 (Thread-1): finished collecting timing info
2021-06-25 00:06:56.436319 (Thread-1): Opening a new connection, currently in state init
2021-06-25 00:06:56.441271 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-25 00:06:57.596510 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2021-06-25 00:06:57.596510 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2021-06-25 00:07:01.654032 (Thread-1): finished collecting timing info
2021-06-25 00:07:01.654032 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8335c881-ccbd-41ae-a6f7-98540e79707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268735529A0>]}
2021-06-25 00:07:01.654032 (Thread-1): 12:07:01 | 1 of 5 OK created table model dbt_petershi.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 5.24s]
2021-06-25 00:07:01.656039 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2021-06-25 00:07:01.656039 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 00:07:01.656039 (Thread-1): 12:07:01 | 2 of 5 START view model dbt_petershi.stg_customers................... [RUN]
2021-06-25 00:07:01.656039 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 00:07:01.657041 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 00:07:01.658044 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 00:07:01.658044 (Thread-1): finished collecting timing info
2021-06-25 00:07:01.688954 (Thread-1): unclosed <socket.socket fd=1068, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 55782), raddr=('142.250.66.202', 443)>
2021-06-25 00:07:01.688954 (Thread-1): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 55781), raddr=('142.250.66.170', 443)>
2021-06-25 00:07:01.704944 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 00:07:01.704944 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:07:01.709934 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-06-25 00:07:03.522903 (Thread-1): finished collecting timing info
2021-06-25 00:07:03.522903 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8335c881-ccbd-41ae-a6f7-98540e79707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026873198A30>]}
2021-06-25 00:07:03.522903 (Thread-1): 12:07:03 | 2 of 5 OK created view model dbt_petershi.stg_customers.............. [OK in 1.87s]
2021-06-25 00:07:03.524520 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 00:07:03.524520 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 00:07:03.524520 (Thread-1): 12:07:03 | 3 of 5 START view model dbt_petershi.stg_orders...................... [RUN]
2021-06-25 00:07:03.524520 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 00:07:03.524520 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 00:07:03.526519 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 00:07:03.526519 (Thread-1): finished collecting timing info
2021-06-25 00:07:03.528514 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 00:07:03.528514 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:07:03.532539 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2021-06-25 00:07:05.690262 (Thread-1): finished collecting timing info
2021-06-25 00:07:05.690262 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8335c881-ccbd-41ae-a6f7-98540e79707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268734E5E50>]}
2021-06-25 00:07:05.690262 (Thread-1): 12:07:05 | 3 of 5 OK created view model dbt_petershi.stg_orders................. [OK in 2.17s]
2021-06-25 00:07:05.691773 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 00:07:05.691773 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2021-06-25 00:07:05.691773 (Thread-1): 12:07:05 | 4 of 5 START view model dbt_petershi.my_second_dbt_model............. [RUN]
2021-06-25 00:07:05.691773 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2021-06-25 00:07:05.691773 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2021-06-25 00:07:05.693772 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-25 00:07:05.694769 (Thread-1): finished collecting timing info
2021-06-25 00:07:05.696763 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2021-06-25 00:07:05.697759 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:07:05.701785 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `silent-caster-317703`.`dbt_petershi`.`my_first_dbt_model`
where id = 1;


2021-06-25 00:07:07.765888 (Thread-1): finished collecting timing info
2021-06-25 00:07:07.766886 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8335c881-ccbd-41ae-a6f7-98540e79707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268731964C0>]}
2021-06-25 00:07:07.766886 (Thread-1): 12:07:07 | 4 of 5 OK created view model dbt_petershi.my_second_dbt_model........ [OK in 2.08s]
2021-06-25 00:07:07.768273 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2021-06-25 00:07:07.768273 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-25 00:07:07.768273 (Thread-1): 12:07:07 | 5 of 5 START table model dbt_petershi.customers...................... [RUN]
2021-06-25 00:07:07.768273 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-25 00:07:07.768273 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-25 00:07:07.771304 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-25 00:07:07.772265 (Thread-1): finished collecting timing info
2021-06-25 00:07:07.773264 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:07:07.777251 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-25 00:07:08.660960 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-25 00:07:08.660960 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 00:07:12.984280 (Thread-1): finished collecting timing info
2021-06-25 00:07:12.984280 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8335c881-ccbd-41ae-a6f7-98540e79707b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268731964C0>]}
2021-06-25 00:07:12.984280 (Thread-1): 12:07:12 | 5 of 5 OK created table model dbt_petershi.customers................. [CREATE TABLE (100.0 rows, 4.3 KB processed) in 5.22s]
2021-06-25 00:07:12.985271 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-25 00:07:12.994459 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 00:07:12.994459 (MainThread): 12:07:12 | 
2021-06-25 00:07:12.995460 (MainThread): 12:07:12 | Finished running 2 table models, 3 view models in 18.41s.
2021-06-25 00:07:12.995796 (MainThread): Connection 'master' was properly closed.
2021-06-25 00:07:12.995796 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-25 00:07:12.995796 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-25 00:07:12.995796 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-25 00:07:13.000784 (MainThread): 
2021-06-25 00:07:13.000784 (MainThread): Completed successfully
2021-06-25 00:07:13.000784 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-06-25 00:07:13.003805 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268733C50A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268733F5DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687345DE80>]}
2021-06-25 00:07:13.003805 (MainThread): Flushing usage events
2021-06-25 00:09:27.595525 (MainThread): Running with dbt=0.19.1
2021-06-25 00:09:27.949877 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-06-25 00:09:27.950874 (MainThread): Tracking: tracking
2021-06-25 00:09:27.967034 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAD0EB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FACC7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FACDC760>]}
2021-06-25 00:09:27.973987 (MainThread): Partial parsing not enabled
2021-06-25 00:09:27.975982 (MainThread): Parsing macros\adapters.sql
2021-06-25 00:09:27.991973 (MainThread): Parsing macros\catalog.sql
2021-06-25 00:09:27.997925 (MainThread): Parsing macros\etc.sql
2021-06-25 00:09:27.999920 (MainThread): Parsing macros\materializations\copy.sql
2021-06-25 00:09:28.002912 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-25 00:09:28.014880 (MainThread): Parsing macros\materializations\seed.sql
2021-06-25 00:09:28.016875 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-25 00:09:28.018902 (MainThread): Parsing macros\materializations\table.sql
2021-06-25 00:09:28.027845 (MainThread): Parsing macros\materializations\view.sql
2021-06-25 00:09:28.031869 (MainThread): Parsing macros\core.sql
2021-06-25 00:09:28.035857 (MainThread): Parsing macros\adapters\common.sql
2021-06-25 00:09:28.073734 (MainThread): Parsing macros\etc\datetime.sql
2021-06-25 00:09:28.081699 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-25 00:09:28.081699 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-25 00:09:28.083694 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-25 00:09:28.084691 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-25 00:09:28.086686 (MainThread): Parsing macros\etc\query.sql
2021-06-25 00:09:28.087683 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-25 00:09:28.095664 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-25 00:09:28.108627 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-25 00:09:28.109625 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-25 00:09:28.114611 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-25 00:09:28.132598 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-25 00:09:28.160535 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-25 00:09:28.161524 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-25 00:09:28.176480 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-25 00:09:28.183454 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-25 00:09:28.187444 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-25 00:09:28.192438 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-25 00:09:28.194434 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-25 00:09:28.196427 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-25 00:09:28.198421 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-25 00:09:28.203409 (MainThread): Partial parsing not enabled
2021-06-25 00:09:28.223357 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-25 00:09:28.232324 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 00:09:28.235324 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 00:09:28.303107 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c2cf37a-20b8-4672-bc73-47da9c25513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAF9F1C0>]}
2021-06-25 00:09:28.308095 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c2cf37a-20b8-4672-bc73-47da9c25513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAEC2850>]}
2021-06-25 00:09:28.308095 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 00:09:28.309092 (MainThread): 
2021-06-25 00:09:28.309092 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 00:09:28.311086 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_silent-caster-317703".
2021-06-25 00:09:28.311086 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 00:09:29.323879 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-25 00:09:29.323879 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 00:09:29.327902 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-25 00:09:30.247066 (MainThread): 12:09:30 | Concurrency: 1 threads (target='dev')
2021-06-25 00:09:30.247066 (MainThread): 12:09:30 | 
2021-06-25 00:09:30.251054 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 00:09:30.251054 (Thread-1): 12:09:30 | 1 of 3 START view model dbt_petershi.stg_customers................... [RUN]
2021-06-25 00:09:30.251748 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 00:09:30.251748 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 00:09:30.252781 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 00:09:30.252781 (Thread-1): finished collecting timing info
2021-06-25 00:09:30.277714 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 00:09:30.277714 (Thread-1): Opening a new connection, currently in state init
2021-06-25 00:09:30.281704 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2021-06-25 00:09:32.600031 (Thread-1): finished collecting timing info
2021-06-25 00:09:32.601029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2cf37a-20b8-4672-bc73-47da9c25513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAEA2820>]}
2021-06-25 00:09:32.601029 (Thread-1): 12:09:32 | 1 of 3 OK created view model dbt_petershi.stg_customers.............. [OK in 2.35s]
2021-06-25 00:09:32.602312 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 00:09:32.602312 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 00:09:32.602312 (Thread-1): 12:09:32 | 2 of 3 START view model dbt_petershi.stg_orders...................... [RUN]
2021-06-25 00:09:32.602312 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 00:09:32.602312 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 00:09:32.603347 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 55800), raddr=('142.250.66.170', 443)>
2021-06-25 00:09:32.603347 (Thread-1): unclosed <socket.socket fd=1088, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 55801), raddr=('142.250.66.202', 443)>
2021-06-25 00:09:32.604310 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 00:09:32.604310 (Thread-1): finished collecting timing info
2021-06-25 00:09:32.606330 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 00:09:32.606330 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:09:32.610328 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `silent-caster-317703`.`dbt_petershi`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2021-06-25 00:09:34.716423 (Thread-1): finished collecting timing info
2021-06-25 00:09:34.717419 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2cf37a-20b8-4672-bc73-47da9c25513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAFC4DC0>]}
2021-06-25 00:09:34.717419 (Thread-1): 12:09:34 | 2 of 3 OK created view model dbt_petershi.stg_orders................. [OK in 2.12s]
2021-06-25 00:09:34.718771 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 00:09:34.718771 (Thread-1): Began running node model.jaffle_shop.customers
2021-06-25 00:09:34.718771 (Thread-1): 12:09:34 | 3 of 3 START table model dbt_petershi.customers...................... [RUN]
2021-06-25 00:09:34.719770 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-25 00:09:34.719770 (Thread-1): Compiling model.jaffle_shop.customers
2021-06-25 00:09:34.721799 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2021-06-25 00:09:34.722764 (Thread-1): finished collecting timing info
2021-06-25 00:09:34.724784 (Thread-1): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 55803), raddr=('142.250.66.202', 443)>
2021-06-25 00:09:34.724784 (Thread-1): unclosed <socket.socket fd=1120, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 55802), raddr=('142.250.66.170', 443)>
2021-06-25 00:09:34.770634 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:09:34.774623 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-25 00:09:35.641396 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2021-06-25 00:09:35.642393 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `silent-caster-317703`.`dbt_petershi`.`customers`
  
  
  OPTIONS()
  as (
    

with customers as (
    select * from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
),

orders as (

select * from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 00:09:40.184133 (Thread-1): finished collecting timing info
2021-06-25 00:09:40.184133 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2cf37a-20b8-4672-bc73-47da9c25513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FB073B20>]}
2021-06-25 00:09:40.184133 (Thread-1): 12:09:40 | 3 of 3 OK created table model dbt_petershi.customers................. [CREATE TABLE (100.0 rows, 4.3 KB processed) in 5.46s]
2021-06-25 00:09:40.185982 (Thread-1): Finished running node model.jaffle_shop.customers
2021-06-25 00:09:40.186983 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 00:09:40.186983 (MainThread): 12:09:40 | 
2021-06-25 00:09:40.187412 (MainThread): 12:09:40 | Finished running 2 view models, 1 table model in 11.88s.
2021-06-25 00:09:40.187412 (MainThread): Connection 'master' was properly closed.
2021-06-25 00:09:40.187412 (MainThread): Connection 'list_silent-caster-317703' was properly closed.
2021-06-25 00:09:40.187412 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-25 00:09:40.187412 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2021-06-25 00:09:40.191437 (MainThread): 
2021-06-25 00:09:40.191437 (MainThread): Completed successfully
2021-06-25 00:09:40.192405 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-25 00:09:40.192405 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAD6BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAF572E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2FAF57760>]}
2021-06-25 00:09:40.192405 (MainThread): Flushing usage events
2021-06-25 00:21:06.552275 (MainThread): Running with dbt=0.19.1
2021-06-25 00:21:06.900008 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\peter.shi\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-06-25 00:21:06.900008 (MainThread): Tracking: tracking
2021-06-25 00:21:06.915592 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E391EB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E38A2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E38BD790>]}
2021-06-25 00:21:06.922129 (MainThread): Partial parsing not enabled
2021-06-25 00:21:06.922129 (MainThread): Parsing macros\adapters.sql
2021-06-25 00:21:06.937785 (MainThread): Parsing macros\catalog.sql
2021-06-25 00:21:06.937785 (MainThread): Parsing macros\etc.sql
2021-06-25 00:21:06.937785 (MainThread): Parsing macros\materializations\copy.sql
2021-06-25 00:21:06.953407 (MainThread): Parsing macros\materializations\incremental.sql
2021-06-25 00:21:06.953407 (MainThread): Parsing macros\materializations\seed.sql
2021-06-25 00:21:06.953407 (MainThread): Parsing macros\materializations\snapshot.sql
2021-06-25 00:21:06.969022 (MainThread): Parsing macros\materializations\table.sql
2021-06-25 00:21:06.969022 (MainThread): Parsing macros\materializations\view.sql
2021-06-25 00:21:06.969022 (MainThread): Parsing macros\core.sql
2021-06-25 00:21:06.984644 (MainThread): Parsing macros\adapters\common.sql
2021-06-25 00:21:07.022427 (MainThread): Parsing macros\etc\datetime.sql
2021-06-25 00:21:07.022427 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-06-25 00:21:07.022427 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-06-25 00:21:07.022427 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-06-25 00:21:07.022427 (MainThread): Parsing macros\etc\is_incremental.sql
2021-06-25 00:21:07.022427 (MainThread): Parsing macros\etc\query.sql
2021-06-25 00:21:07.038076 (MainThread): Parsing macros\materializations\helpers.sql
2021-06-25 00:21:07.038076 (MainThread): Parsing macros\materializations\common\merge.sql
2021-06-25 00:21:07.053708 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-06-25 00:21:07.053708 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-06-25 00:21:07.053708 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-06-25 00:21:07.076209 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-06-25 00:21:07.107455 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-06-25 00:21:07.107455 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-06-25 00:21:07.122494 (MainThread): Parsing macros\materializations\table\table.sql
2021-06-25 00:21:07.138152 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-06-25 00:21:07.138152 (MainThread): Parsing macros\materializations\view\view.sql
2021-06-25 00:21:07.138152 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-06-25 00:21:07.153739 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-06-25 00:21:07.153739 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-06-25 00:21:07.153739 (MainThread): Parsing macros\schema_tests\unique.sql
2021-06-25 00:21:07.153739 (MainThread): Partial parsing not enabled
2021-06-25 00:21:07.169396 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2021-06-25 00:21:07.185019 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 00:21:07.185019 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 00:21:07.254049 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5be36323-4212-4d2b-9b2e-64faf762fd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E3B7E1F0>]}
2021-06-25 00:21:07.254049 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5be36323-4212-4d2b-9b2e-64faf762fd3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E3AA0A00>]}
2021-06-25 00:21:07.254049 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 00:21:07.254049 (MainThread): 
2021-06-25 00:21:07.254049 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 00:21:07.269670 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_silent-caster-317703_dbt_petershi".
2021-06-25 00:21:07.269670 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 00:21:07.269670 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-06-25 00:21:08.620109 (MainThread): 12:21:08 | Concurrency: 1 threads (target='dev')
2021-06-25 00:21:08.620109 (MainThread): 12:21:08 | 
2021-06-25 00:21:08.626120 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-06-25 00:21:08.626120 (Thread-1): 12:21:08 | 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-06-25 00:21:08.626120 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2021-06-25 00:21:08.626120 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-06-25 00:21:08.626120 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2021-06-25 00:21:08.626120 (Thread-1): finished collecting timing info
2021-06-25 00:21:08.626120 (Thread-1): Opening a new connection, currently in state init
2021-06-25 00:21:08.626120 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `silent-caster-317703`.`dbt_petershi`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors



2021-06-25 00:21:11.862519 (Thread-1): finished collecting timing info
2021-06-25 00:21:11.862519 (Thread-1): 12:21:11 | 1 of 7 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 3.24s]
2021-06-25 00:21:11.862519 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2021-06-25 00:21:11.862519 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2021-06-25 00:21:11.862519 (Thread-1): 12:21:11 | 2 of 7 START test not_null_customers_customer_id..................... [RUN]
2021-06-25 00:21:11.862519 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2021-06-25 00:21:11.862519 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2021-06-25 00:21:11.862519 (Thread-1): unclosed <socket.socket fd=1040, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61125), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:11.862519 (Thread-1): unclosed <socket.socket fd=1056, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61126), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:11.862519 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2021-06-25 00:21:11.862519 (Thread-1): finished collecting timing info
2021-06-25 00:21:11.862519 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:21:11.862519 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `silent-caster-317703`.`dbt_petershi`.`customers`
where customer_id is null



2021-06-25 00:21:14.658848 (Thread-1): finished collecting timing info
2021-06-25 00:21:14.658848 (Thread-1): 12:21:14 | 2 of 7 PASS not_null_customers_customer_id........................... [PASS in 2.80s]
2021-06-25 00:21:14.658848 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2021-06-25 00:21:14.658848 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 00:21:14.658848 (Thread-1): 12:21:14 | 3 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-25 00:21:14.658848 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 00:21:14.658848 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 00:21:14.658848 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 00:21:14.658848 (Thread-1): finished collecting timing info
2021-06-25 00:21:14.658848 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:21:14.674205 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
where customer_id is null



2021-06-25 00:21:17.496699 (Thread-1): finished collecting timing info
2021-06-25 00:21:17.496699 (Thread-1): 12:21:17 | 3 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 2.84s]
2021-06-25 00:21:17.496699 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 00:21:17.496699 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2021-06-25 00:21:17.496699 (Thread-1): 12:21:17 | 4 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2021-06-25 00:21:17.496699 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2021-06-25 00:21:17.496699 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2021-06-25 00:21:17.496699 (Thread-1): unclosed <socket.socket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61129), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:17.496699 (Thread-1): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61130), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:17.496699 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2021-06-25 00:21:17.496699 (Thread-1): finished collecting timing info
2021-06-25 00:21:17.496699 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:21:17.496699 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `silent-caster-317703`.`dbt_petershi`.`stg_orders`
where order_id is null



2021-06-25 00:21:20.518072 (Thread-1): finished collecting timing info
2021-06-25 00:21:20.518072 (Thread-1): 12:21:20 | 4 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 3.02s]
2021-06-25 00:21:20.518072 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2021-06-25 00:21:20.518072 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2021-06-25 00:21:20.518072 (Thread-1): 12:21:20 | 5 of 7 START test unique_customers_customer_id....................... [RUN]
2021-06-25 00:21:20.518072 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2021-06-25 00:21:20.518072 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2021-06-25 00:21:20.518072 (Thread-1): unclosed <socket.socket fd=896, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61127), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:20.518072 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61128), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:20.518072 (Thread-1): unclosed <socket.socket fd=1180, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61132), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:20.518072 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61131), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:20.518072 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2021-06-25 00:21:20.518072 (Thread-1): finished collecting timing info
2021-06-25 00:21:20.518072 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:21:20.537765 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `silent-caster-317703`.`dbt_petershi`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 00:21:23.552244 (Thread-1): finished collecting timing info
2021-06-25 00:21:23.552244 (Thread-1): 12:21:23 | 5 of 7 PASS unique_customers_customer_id............................. [PASS in 3.03s]
2021-06-25 00:21:23.553240 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2021-06-25 00:21:23.553240 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 00:21:23.553240 (Thread-1): 12:21:23 | 6 of 7 START test unique_stg_customers_customer_id................... [RUN]
2021-06-25 00:21:23.553240 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 00:21:23.554239 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 00:21:23.595402 (Thread-1): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61136), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:23.595402 (Thread-1): unclosed <socket.socket fd=1148, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61137), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:23.599363 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 00:21:23.600393 (Thread-1): finished collecting timing info
2021-06-25 00:21:23.600393 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:21:23.606077 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `silent-caster-317703`.`dbt_petershi`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 00:21:26.706951 (Thread-1): finished collecting timing info
2021-06-25 00:21:26.706951 (Thread-1): 12:21:26 | 6 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 3.15s]
2021-06-25 00:21:26.707972 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 00:21:26.708945 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2021-06-25 00:21:26.708945 (Thread-1): 12:21:26 | 7 of 7 START test unique_stg_orders_order_id......................... [RUN]
2021-06-25 00:21:26.708945 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2021-06-25 00:21:26.708945 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2021-06-25 00:21:26.711935 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2021-06-25 00:21:26.712932 (Thread-1): finished collecting timing info
2021-06-25 00:21:26.712932 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 00:21:26.716921 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `silent-caster-317703`.`dbt_petershi`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-06-25 00:21:29.560554 (Thread-1): finished collecting timing info
2021-06-25 00:21:29.560554 (Thread-1): 12:21:29 | 7 of 7 PASS unique_stg_orders_order_id............................... [PASS in 2.85s]
2021-06-25 00:21:29.561556 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2021-06-25 00:21:29.563563 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 00:21:29.563651 (MainThread): 12:21:29 | 
2021-06-25 00:21:29.563651 (MainThread): 12:21:29 | Finished running 7 tests in 22.31s.
2021-06-25 00:21:29.563651 (MainThread): Connection 'master' was properly closed.
2021-06-25 00:21:29.563651 (MainThread): Connection 'list_silent-caster-317703_dbt_petershi' was properly closed.
2021-06-25 00:21:29.563651 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2021-06-25 00:21:29.563651 (MainThread): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61140), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:29.563651 (MainThread): unclosed <socket.socket fd=1308, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.1.57', 61141), raddr=('142.250.66.202', 443)>
2021-06-25 00:21:29.563651 (MainThread): 
2021-06-25 00:21:29.563651 (MainThread): Completed successfully
2021-06-25 00:21:29.563651 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-06-25 00:21:29.563651 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E3B135B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E3B1A940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151E38896A0>]}
2021-06-25 00:21:29.563651 (MainThread): Flushing usage events
